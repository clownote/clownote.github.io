<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Notes of Andrew Ng‚Äôs Machine Learning ‚Äî‚Äî (15) Anomaly DetectionDensity EstimationProblem MotivationAnomaly Detection is a type of machine learning problem. Imagine that you‚Äôre a manufacturer of aircra">
<meta property="og:type" content="article">
<meta property="og:title" content="ÂºÇÂ∏∏Ê£ÄÊµã">
<meta property="og:url" content="https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/index.html">
<meta property="og:site_name" content="clownote">
<meta property="og:description" content="Notes of Andrew Ng‚Äôs Machine Learning ‚Äî‚Äî (15) Anomaly DetectionDensity EstimationProblem MotivationAnomaly Detection is a type of machine learning problem. Imagine that you‚Äôre a manufacturer of aircra">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g8xdwc6zf8j30p10c2gpb.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g8xebhrku9j30nl0d7gqi.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g8yum81cydj30je0c3410.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zz0ijc4cj310f0khn20.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zz0b347dj31050jswgw.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g90vvgj48aj30qs08ijtu.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g90wc7yk3gj30m807x40w.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g90zj4eo2fj31xy0h37wh.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g90zjbm1afj31xy0h31kx.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g92bif84qwj30la05ajtx.jpg">
<meta property="article:published_time" content="2019-11-26T15:02:40.000Z">
<meta property="article:modified_time" content="2021-01-14T04:02:37.301Z">
<meta property="article:author" content="CDFMLR">
<meta property="article:tag" content="Machine Learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/006y8mN6ly1g8xdwc6zf8j30p10c2gpb.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/rabbit.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/rabbit_192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/rabbit_180.png">
          
        
    
    <!-- title -->
    <title>ÂºÇÂ∏∏Ê£ÄÊµã</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
    <!--Google search varification (PRIVATE)-->
    <meta name="google-site-verification" content="MrqlpFAD8nDanw3Ypv7ZsIWHLnTdhRuLa4QhSVwxIvc" />
    <!--Google AdSense ÂÖ≥ËÅî (PRIVATE)-->
    <script data-ad-client="ca-pub-1510963483941114" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">È¶ñÈ°µ</a></li>
         
          <li><a href="/about/">ÂÖ≥‰∫é</a></li>
         
          <li><a href="/archives/">ÂΩíÊ°£</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">È°πÁõÆ</a></li>
         
          <li><a href="/search/">ÊêúÁ¥¢</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/12/05/AndrewNgML/AndrewNg-MachineLearning-16-RecommenderSystems/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/11/18/blog/mac-localsnapshot-occupy/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">‰∏ä‰∏ÄÁØá</span>
      <span id="i-next" class="info" style="display:none;">‰∏ã‰∏ÄÁØá</span>
      <span id="i-top" class="info" style="display:none;">ËøîÂõûÈ°∂ÈÉ®</span>
      <span id="i-share" class="info" style="display:none;">ÂàÜ‰∫´ÊñáÁ´†</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&text=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&is_video=false&description=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ÂºÇÂ∏∏Ê£ÄÊµã&body=Check out this article: https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&name=ÂºÇÂ∏∏Ê£ÄÊµã&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Notes-of-Andrew-Ng%E2%80%99s-Machine-Learning-%E2%80%94%E2%80%94-15-Anomaly-Detection"><span class="toc-number">1.</span> <span class="toc-text">Notes of Andrew Ng‚Äôs Machine Learning ‚Äî‚Äî (15) Anomaly Detection</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Density-Estimation"><span class="toc-number">1.1.</span> <span class="toc-text">Density Estimation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-Motivation"><span class="toc-number">1.1.1.</span> <span class="toc-text">Problem Motivation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Anomaly-detection-example"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">Anomaly detection example</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gaussian-Distribution"><span class="toc-number">1.1.2.</span> <span class="toc-text">Gaussian Distribution</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Parameter-estimation"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">Parameter estimation</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Anomaly-detection-algorithm"><span class="toc-number">1.1.3.</span> <span class="toc-text">Anomaly detection algorithm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Building-an-Anomaly-Detection-System"><span class="toc-number">1.2.</span> <span class="toc-text">Building an Anomaly Detection System</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Developing-and-Evaluating-an-Anomaly-Detection-System"><span class="toc-number">1.2.1.</span> <span class="toc-text">Developing and Evaluating an Anomaly Detection System</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Anomaly-Detection-vs-Supervised-Learning"><span class="toc-number">1.2.2.</span> <span class="toc-text">Anomaly Detection vs. Supervised Learning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Choosing-What-Features-to-Use"><span class="toc-number">1.2.3.</span> <span class="toc-text">Choosing What Features to Use</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#preprocess-non-gaussian-features"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">preprocess non-gaussian features</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Error-analysis-for-anomaly-detection"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">Error analysis for anomaly detection</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Multivariate-Gaussian-distribution"><span class="toc-number">1.3.</span> <span class="toc-text">Multivariate Gaussian distribution</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Multivariate-Gaussian-Distribution"><span class="toc-number">1.3.1.</span> <span class="toc-text">Multivariate Gaussian Distribution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Anomaly-Detection-using-the-Multivariate-Gaussian-Distribution"><span class="toc-number">1.3.2.</span> <span class="toc-text">Anomaly Detection using the Multivariate Gaussian Distribution</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Using-the-Multivariate-Gaussian-Distribution"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Using the Multivariate Gaussian Distribution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Relationship-to-original-model"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">Relationship to original model</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Original-model-vs-Multivariate-gaussian"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">Original model vs. Multivariate gaussian</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        ÂºÇÂ∏∏Ê£ÄÊµã
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">clownote</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-11-26T15:02:40.000Z" itemprop="datePublished">2019-11-26</time>
        
        (Updated: <time datetime="2021-01-14T04:02:37.301Z" itemprop="dateModified">2021-01-14</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Machine-Learning/">Machine Learning</a> ‚Ä∫ <a class="category-link" href="/categories/Machine-Learning/AndrewNg/">AndrewNg</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Notes-of-Andrew-Ng‚Äôs-Machine-Learning-‚Äî‚Äî-15-Anomaly-Detection"><a href="#Notes-of-Andrew-Ng‚Äôs-Machine-Learning-‚Äî‚Äî-15-Anomaly-Detection" class="headerlink" title="Notes of Andrew Ng‚Äôs Machine Learning ‚Äî‚Äî (15) Anomaly Detection"></a>Notes of Andrew Ng‚Äôs Machine Learning ‚Äî‚Äî (15) Anomaly Detection</h1><h2 id="Density-Estimation"><a href="#Density-Estimation" class="headerlink" title="Density Estimation"></a>Density Estimation</h2><h3 id="Problem-Motivation"><a href="#Problem-Motivation" class="headerlink" title="Problem Motivation"></a>Problem Motivation</h3><p><em>Anomaly Detection</em> is a type of machine learning problem.</p>
<p>Imagine that you‚Äôre a manufacturer of aircraft engines, and let‚Äôs say that as your aircraft engines roll off the assembly line, you‚Äôre doing quality assurance testing, and as part of that testing you measure features of your aircraft engine, like the heat generated, the vibrations and so on. So you now have a data set of $x_1$ through $x_m$, if you have manufactured $m$ aircraft engines and plot your data. Then, given a new engine $x_{test}$, you want to know is $x_{test}$ anomalous? This problem is called <strong>Anomaly Detection</strong>.</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8xdwc6zf8j30p10c2gpb.jpg" alt="image-20191114105935962"></p>
<p>Here is want we are going to do:</p>
<blockquote>
<p>Dataset: ${x^{(1)},x^{(2)},\cdots,x^{(m)}}$</p>
<p>Is $x_{test}$ anomalous?</p>
</blockquote>
<p>To solve this problem, we will train a model for $p(x)$ (i.e. a model for the <strong>probability</strong> of $x$, where $x$ are these features of, say, aircraft engines). We‚Äôre then going to say that for the new aircraft engine, if $p(x_{test})$ is less than some $\epsilon$ then we flag this as an anomaly:<br>$$<br>\begin{array}{l}<br>p(x_{test})&lt;\epsilon \Rightarrow \textrm{anomaly}\<br>p(x_{test})\ge\epsilon \Rightarrow \textrm{OK}<br>\end{array}<br>$$<br>This problem of estimating this distribution $p(x)$ are sometimes called the problem of <em>density estimation</em>.</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8xebhrku9j30nl0d7gqi.jpg" alt="image-20191114111418858"></p>
<h4 id="Anomaly-detection-example"><a href="#Anomaly-detection-example" class="headerlink" title="Anomaly detection example"></a>Anomaly detection example</h4><p><strong>Anomaly detec-on example</strong> </p>
<p>Fraud detection</p>
<ul>
<li>$x^{(i)}$= features of user $i$‚Äôs actvities </li>
<li>Model $p(x)$ from data.</li>
<li>Idenify unusual users by checking which have $p(x)&lt;\epsilon$</li>
</ul>
<p>Manufacturing  (Monitoring computers in a data center )</p>
<ul>
<li><p>$x^{(i)}$ = features of machine $i$</p>
</li>
<li><p>$x_1$ = memory use, $x_2$ = number of disk accesses/sec, $x_3$ = CPU load, $x_4$ = CPU load/network traffic ‚Ä¶</p>
</li>
</ul>
<h3 id="Gaussian-Distribution"><a href="#Gaussian-Distribution" class="headerlink" title="Gaussian Distribution"></a>Gaussian Distribution</h3><p><strong>Gaussian distribution</strong> which is also called the <em>normal distribution</em>.</p>
<p>If $x$ is a distributed Gaussian with mean $\mu$, variance $\sigma^2$, we will write it as:<br>$$<br>x \sim \mathcal{N}(\mu,\sigma^2)<br>$$<br>In this case, the probability of $x$ is:<br>$$<br>p(x) = \frac{1}{\sqrt{2\pi}\sigma}\exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)<br>$$</p>
<p>There is some example of Gaussian distribution:</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8yum81cydj30je0c3410.jpg" alt="image-20191115172344685"></p>
<p>We can see that the ‚Äúcenter‚Äù of these plots is actually the value of $\mu$. And with our $\sigma$ increasing,  the plots is more and more ‚Äúflat‚Äù. Or, it will be ‚Äúthin &amp; tall‚Äù if $\sigma$ is small.</p>
<h4 id="Parameter-estimation"><a href="#Parameter-estimation" class="headerlink" title="Parameter estimation"></a>Parameter estimation</h4><p>Given a dataset: ${x^{(1)},x^{(2)},\cdots,x^{(m)}}$, we can get our $\mu$ and $\sigma$ by:<br>$$<br>\mu=\frac{1}{m}\sum_{i=1}^{m}x^{(i)}<br>$$</p>
<p>$$<br>\sigma^2=\frac{1}{m}\sum_{i=1}^{m}\left(x^{(i)}-\mu\right)^2<br>$$</p>
<p>P.S. this is what people turn to use when handling a machine learning problem, it‚Äôs a little different from what we normally utilize in mathematics.</p>
<h3 id="Anomaly-detection-algorithm"><a href="#Anomaly-detection-algorithm" class="headerlink" title="Anomaly detection algorithm"></a>Anomaly detection algorithm</h3><ol>
<li><p>Choose features $x_i$ that you think might be indicative of anomalous examples.</p>
</li>
<li><p>Fit parameters $\mu_1,\cdots,\mu_n,\sigma_1^2,\cdots,\sigma_n^2$: (I wrote the vectorilized version)<br>$$<br>\mu=\frac{1}{m}\sum_{i=1}^{m}x^{(i)}<br>$$</p>
<p>$$<br>\sigma^2=\frac{1}{m}\sum_{i=1}^{m}\left(x^{(i)}-\mu\right)^2<br>$$</p>
</li>
<li><p>Given new example $x$, compute $p(x)$:<br>$$<br>p(x)=\prod_{j=1}^{n}p(x_j;\mu_j,\sigma_j^2)=\prod_{j=1}^{n}\frac{1}{\sqrt{2\pi}\sigma_j}\exp\left(-\frac{(x_j-\mu_j)^2}{2\sigma_j^2}\right)<br>$$</p>
</li>
<li><p>Anomaly if $p(x)&lt;\epsilon$</p>
</li>
</ol>
<h2 id="Building-an-Anomaly-Detection-System"><a href="#Building-an-Anomaly-Detection-System" class="headerlink" title="Building an Anomaly Detection System"></a>Building an Anomaly Detection System</h2><h3 id="Developing-and-Evaluating-an-Anomaly-Detection-System"><a href="#Developing-and-Evaluating-an-Anomaly-Detection-System" class="headerlink" title="Developing and Evaluating an Anomaly Detection System"></a>Developing and Evaluating an Anomaly Detection System</h3><p><strong>The importance of real-number evalua-on</strong> </p>
<p>When developing a learning algorithm (choosing features, etc.), making decisions is much easier if we have a way of evalua-ng our learning algorithm. </p>
<p>Assume we have some labeled data, of anomalous and non- anomalous examples. ($y=0$ if normal, $y=1$ if anomalous). </p>
<ul>
<li><p><code>Training set</code>: $x^{(1)},x^{(2)},\cdots,x^{(m)}$ (assume normal examples/not anomalous)</p>
</li>
<li><p><code>Cross validation set</code>: $\left(x_{cv}^{(1)},y_{cv}^{(1)}\right),\cdots,\left(x_{cv}^{(m_{cv})},y_{cv}^{(m_{cv})}\right)$</p>
</li>
<li><p><code>Test set</code>: $\left(x_{test}^{(1)},y_{test}^{(1)}\right),\cdots,\left(x_{test}^{(m_{test})},y_{test}^{(m_{test})}\right)$</p>
</li>
</ul>
<p><strong>Aircraft engines motivating example</strong> </p>
<p>Say, what we have is:</p>
<ul>
<li>10000 good (normal) engines  ($y=0$)</li>
<li>20 flawed engines (anomalous)   ($y=1$)</li>
</ul>
<p>Than we are going to choose:</p>
<ul>
<li>Training set: 6000 good engines</li>
<li>CV: 2000 good engines ($y=0$), 10 anomalous ($y=1$)</li>
<li>Test: 2000 good engines ($y=0$), 10 anomalous ($y=1$) </li>
</ul>
<p><strong>Algorithm evaluation</strong></p>
<p>Fit model $p(x)$ on training set ${x^{(1)},\cdots,x^{(m)}}$</p>
<p>On a cross validation/test example $x$, predict:<br>$$<br>y = \left{\begin{array}{ll}<br>1 &amp; \textrm{if } p(x) &lt; \epsilon \quad \textrm{(anomaly)}\<br>0 &amp; \textrm{if } p(x) \ge \epsilon \quad \textrm{(normal)}\<br>\end{array}\right.<br>$$<br>Possible evaluation matrices:</p>
<ul>
<li>True positive, false positive, false negative, true negative </li>
<li>Precision/Recall</li>
<li>$F_1$-score </li>
</ul>
<p>Can also use cross valida-on set to choose parameter $\epsilon$.</p>
<h3 id="Anomaly-Detection-vs-Supervised-Learning"><a href="#Anomaly-Detection-vs-Supervised-Learning" class="headerlink" title="Anomaly Detection vs. Supervised Learning"></a>Anomaly Detection vs. Supervised Learning</h3><p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zz0ijc4cj310f0khn20.jpg" alt="image-20191116164047663"></p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g8zz0b347dj31050jswgw.jpg" alt="image-20191116164113192"></p>
<p>There are some more examples:</p>
<ul>
<li><p>(Anomaly Detection) You run a power utility (supplying electricity to customers) and want to monitor your electric plants to see if any one of them might be behaving strangely.</p>
</li>
<li><p>(Supervised Learning) You run a power utility and want to predict tomorrow‚Äôs expected demand for electricity (so that you can plan to ramp up an appropriate amount of generation capacity).</p>
</li>
<li><p>(Anomaly Detection) A computer vision / security application, where you examine video images to see if anyone in your company‚Äôs parking lot is acting in an unusual way.</p>
</li>
<li><p>(Supervised Learning) A computer vision application, where you examine an image of a person entering your retail store to determine if the person is male or female.</p>
</li>
</ul>
<h3 id="Choosing-What-Features-to-Use"><a href="#Choosing-What-Features-to-Use" class="headerlink" title="Choosing What Features to Use"></a>Choosing What Features to Use</h3><h4 id="preprocess-non-gaussian-features"><a href="#preprocess-non-gaussian-features" class="headerlink" title="preprocess non-gaussian features"></a>preprocess non-gaussian features</h4><p>We can use <code>hist</code> in octave to plot out the histogram of our data, if we find that it is non-gaussian, we can try to apply a $\log(x+c)$ or $x^{\frac{1}{c}}$ (try different $c$ for a better result) to make it looks more gaussian. For example:</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g90vvgj48aj30qs08ijtu.jpg" alt="image-20191117113816740"></p>
<h4 id="Error-analysis-for-anomaly-detection"><a href="#Error-analysis-for-anomaly-detection" class="headerlink" title="Error analysis for anomaly detection"></a>Error analysis for anomaly detection</h4><p>What we want is:</p>
<ul>
<li>$p(x)$ large for normal examples $x$.</li>
<li>$p(x)$ small for anomalous examples $x$.</li>
</ul>
<p>And the most common problem is:</p>
<blockquote>
<p>$p(x)$ is comparable (say, both large) for normal and anomalous examples.</p>
</blockquote>
<p>Suppose our anomaly detection algorithm is performing poorly and outputs a large value of p(x) for many normal examples and for many anomalous examples in the cross validation dataset, what is most likely to help is to try coming up with more features to distinguish between the normal and the anomalous examples.</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g90wc7yk3gj30m807x40w.jpg" alt="image-20191117115423248"></p>
<h2 id="Multivariate-Gaussian-distribution"><a href="#Multivariate-Gaussian-distribution" class="headerlink" title="Multivariate Gaussian distribution"></a>Multivariate Gaussian distribution</h2><h3 id="Multivariate-Gaussian-Distribution"><a href="#Multivariate-Gaussian-Distribution" class="headerlink" title="Multivariate Gaussian Distribution"></a>Multivariate Gaussian Distribution</h3><p>What we still want to do is:</p>
<ul>
<li>Given $x\in\R^n$.</li>
<li>Don‚Äôt model $p(x_1),p(x_2),\cdots$ separately.</li>
<li>Model $p(x)$ all in one go.</li>
</ul>
<p><em>Multivariate gaussian</em> is able to make it:<br>$$<br>p(x;\mu,\Sigma)=\frac<br>{\exp\left(-\frac{1}{2}(x-\mu)^T\Sigma^{-1}(x-\mu)\right)}<br>{\sqrt{(2\pi)^{n}|\Sigma|}}<br>$$<br>P.s. $|\Sigma| = \det\Sigma $ is the determinant of $\Sigma$ .</p>
<p>Where we need parameters:</p>
<ul>
<li>$\mu\in\R^n$</li>
<li>$\Sigma\in\R^{n\times n}$ (covariance matrix, <code>Sigma = 1/m * X&#39; * X;</code>)</li>
</ul>
<p>Given training set ${x^{(1)},\cdots,x^{(m)}}$, we can fit the parameters:<br>$$<br>\mu=\frac{1}{m}\sum_{i=1}^mx^{(i)} \qquad<br>\Sigma=\frac{1}{m}\sum_{i=1}^m\left(x^{(i)}-\mu\right)\left(x^{(i)}-\mu\right)^T<br>$$</p>
<p>Here are lots of examples:</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g90zj4eo2fj31xy0h37wh.jpg" alt="Â±èÂπïÂø´ÁÖß 2019-11-17 13.39.08 3"></p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g90zjbm1afj31xy0h31kx.jpg" alt="Â±èÂπïÂø´ÁÖß 2019-11-17 13.39.08 2"></p>
<h3 id="Anomaly-Detection-using-the-Multivariate-Gaussian-Distribution"><a href="#Anomaly-Detection-using-the-Multivariate-Gaussian-Distribution" class="headerlink" title="Anomaly Detection using the Multivariate Gaussian Distribution"></a>Anomaly Detection using the Multivariate Gaussian Distribution</h3><h4 id="Using-the-Multivariate-Gaussian-Distribution"><a href="#Using-the-Multivariate-Gaussian-Distribution" class="headerlink" title="Using the Multivariate Gaussian Distribution"></a>Using the Multivariate Gaussian Distribution</h4><ol>
<li><p>Fit model $p(x)$ by setting:<br>$$<br>\mu=\frac{1}{m}\sum_{i=1}^mx^{(i)} \qquad<br>\Sigma=\frac{1}{m}\sum_{i=1}^m\left(x^{(i)}-\mu\right)\left(x^{(i)}-\mu\right)^T<br>$$</p>
</li>
<li><p>Given a new example $x$, compute:<br>$$<br>p(x)=\frac<br>{\exp\left(-\frac{1}{2}(x-\mu)^T\Sigma^{-1}(x-\mu)\right)}<br>{\sqrt{(2\pi)^{n}|\Sigma|}}<br>$$</p>
</li>
<li><p>Flag an anomaly if $p(x)&lt;\epsilon$</p>
</li>
</ol>
<h4 id="Relationship-to-original-model"><a href="#Relationship-to-original-model" class="headerlink" title="Relationship to original model"></a>Relationship to original model</h4><p>Original model: $p(x)=p(x_1;\mu_1,\sigma_1^2)\times p(x_2;\mu_2,\sigma_2^2) \times \cdots \times p(x_n;\mu_n,\sigma_n^2)$</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g92bif84qwj30la05ajtx.jpg" alt="image-20191118172458083"></p>
<p>As we can see, the contours of the Original model are always <strong>axis aligned</strong>.</p>
<p> This model actually corresponds to a special case of a multivariate Gaussian distribution $p(x)=\frac{\exp\left(-\frac{1}{2}(x-\mu)^T\Sigma^{-1}(x-\mu)\right)}<br>{\sqrt{(2\pi)^{n}|\Sigma|}}$ where:<br>$$<br>\Sigma=\left[\begin{array}{cccc}<br>\sigma_1^2 \<br> &amp; \sigma_1^2 \<br> &amp; &amp; \ddots \<br> &amp; &amp; &amp; \sigma_n^2<br>\end{array}\right]<br>$$</p>
<h4 id="Original-model-vs-Multivariate-gaussian"><a href="#Original-model-vs-Multivariate-gaussian" class="headerlink" title="Original model vs. Multivariate gaussian"></a>Original model vs. Multivariate gaussian</h4><p>Original model:</p>
<ul>
<li>$p(x)=p(x_1;\mu_1,\sigma_1^2)\times \cdots \times p(x_n;\mu_n,\sigma_n^2)$</li>
<li>Manually create features to capture anomalies where $x_1,x_2$ take unusual combinations of values. (e.g. $x_3=\frac{x_1}{x_2}$)</li>
<li>Computationally cheaper (alternatively, scales better to large $n$)</li>
<li>OK even if $m$ (training set size) is small</li>
</ul>
<p>Multivariate gaussian:</p>
<ul>
<li>$p(x)=\frac{\exp\left(-\frac{1}{2}(x-\mu)^T\Sigma^{-1}(x-\mu)\right)}<br>{\sqrt{(2\pi)^{n}|\Sigma|}}$</li>
<li>Automatically captures correlations between features (no need to create a $x_3=\frac{x_1}{x_2}$)</li>
<li>Computationally more expensive</li>
<li>Must have $m&gt;n$ &amp; all features are not redundant (need to promise that there are no features that are linearly dependent) or else $\Sigma$ is non-invertible.</li>
</ul>

  </div>
</article>
<!--Disqus-->


<!--Livere-->

    <div class="blog-post-comments">
        <div id="lv-container" data-id="city" data-uid="MTAyMC80NjEzMi8yMjY0Mw==">
            <noscript>‰∏çÂêØÁî® JavaScript ÊîØÊåÅÁöÑ‰∫∫ÊòØÁúã‰∏çÂà∞ÂèØÁà±ÁöÑËØÑËÆ∫Âå∫ÁöÑ„ÄÇüò•</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">È¶ñÈ°µ</a></li>
         
          <li><a href="/about/">ÂÖ≥‰∫é</a></li>
         
          <li><a href="/archives/">ÂΩíÊ°£</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">È°πÁõÆ</a></li>
         
          <li><a href="/search/">ÊêúÁ¥¢</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Notes-of-Andrew-Ng%E2%80%99s-Machine-Learning-%E2%80%94%E2%80%94-15-Anomaly-Detection"><span class="toc-number">1.</span> <span class="toc-text">Notes of Andrew Ng‚Äôs Machine Learning ‚Äî‚Äî (15) Anomaly Detection</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Density-Estimation"><span class="toc-number">1.1.</span> <span class="toc-text">Density Estimation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-Motivation"><span class="toc-number">1.1.1.</span> <span class="toc-text">Problem Motivation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Anomaly-detection-example"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">Anomaly detection example</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Gaussian-Distribution"><span class="toc-number">1.1.2.</span> <span class="toc-text">Gaussian Distribution</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Parameter-estimation"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">Parameter estimation</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Anomaly-detection-algorithm"><span class="toc-number">1.1.3.</span> <span class="toc-text">Anomaly detection algorithm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Building-an-Anomaly-Detection-System"><span class="toc-number">1.2.</span> <span class="toc-text">Building an Anomaly Detection System</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Developing-and-Evaluating-an-Anomaly-Detection-System"><span class="toc-number">1.2.1.</span> <span class="toc-text">Developing and Evaluating an Anomaly Detection System</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Anomaly-Detection-vs-Supervised-Learning"><span class="toc-number">1.2.2.</span> <span class="toc-text">Anomaly Detection vs. Supervised Learning</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Choosing-What-Features-to-Use"><span class="toc-number">1.2.3.</span> <span class="toc-text">Choosing What Features to Use</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#preprocess-non-gaussian-features"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">preprocess non-gaussian features</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Error-analysis-for-anomaly-detection"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">Error analysis for anomaly detection</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Multivariate-Gaussian-distribution"><span class="toc-number">1.3.</span> <span class="toc-text">Multivariate Gaussian distribution</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Multivariate-Gaussian-Distribution"><span class="toc-number">1.3.1.</span> <span class="toc-text">Multivariate Gaussian Distribution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Anomaly-Detection-using-the-Multivariate-Gaussian-Distribution"><span class="toc-number">1.3.2.</span> <span class="toc-text">Anomaly Detection using the Multivariate Gaussian Distribution</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Using-the-Multivariate-Gaussian-Distribution"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">Using the Multivariate Gaussian Distribution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Relationship-to-original-model"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">Relationship to original model</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Original-model-vs-Multivariate-gaussian"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">Original model vs. Multivariate gaussian</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&text=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&is_video=false&description=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ÂºÇÂ∏∏Ê£ÄÊµã&body=Check out this article: https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&title=ÂºÇÂ∏∏Ê£ÄÊµã"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://clownote.github.io/2019/11/26/AndrewNgML/AndrewNg-MachineLearning-15-AnomalyDetection/&name=ÂºÇÂ∏∏Ê£ÄÊµã&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> ËèúÂçï</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> ÁõÆÂΩï</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> ÂàÜ‰∫´</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> ËøîÂõûÈ°∂ÈÉ®</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 CDFMLR
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">È¶ñÈ°µ</a></li>
         
          <li><a href="/about/">ÂÖ≥‰∫é</a></li>
         
          <li><a href="/archives/">ÂΩíÊ°£</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">È°πÁõÆ</a></li>
         
          <li><a href="/search/">ÊêúÁ¥¢</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Â§çÂà∂Âà∞Á≤òË¥¥Êùø!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Â§çÂà∂ÊàêÂäü!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-146911386-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?9a0d2e6fde93dad496ac79f04f3aba97";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


<!--Livere Comments-->

    <script type="text/javascript">
      (function (d, s) {
        var j, e = d.getElementsByTagName(s)[0];

        if (typeof LivereTower === 'function') { return; }

        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;

        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>

</body>
</html>
