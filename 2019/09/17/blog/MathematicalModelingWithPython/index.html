<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="用 Python 做数学建模线性规划 第三方依赖库：scipy。  用 scipy.optimize.linprog 可以解线性规划问题： 1linprog(c, A_ub&#x3D;None, b_ub&#x3D;None, A_eq&#x3D;None, b_eq&#x3D;None, bounds&#x3D;None, method&#x3D;&amp;#x27;simplex&amp;#x27;, callback&#x3D;None, options&#x3D;None) 其规定的">
<meta property="og:type" content="article">
<meta property="og:title" content="用 Python 做数学建模">
<meta property="og:url" content="https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/index.html">
<meta property="og:site_name" content="clownote">
<meta property="og:description" content="用 Python 做数学建模线性规划 第三方依赖库：scipy。  用 scipy.optimize.linprog 可以解线性规划问题： 1linprog(c, A_ub&#x3D;None, b_ub&#x3D;None, A_eq&#x3D;None, b_eq&#x3D;None, bounds&#x3D;None, method&#x3D;&amp;#x27;simplex&amp;#x27;, callback&#x3D;None, options&#x3D;None) 其规定的">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-09-17T15:00:38.000Z">
<meta property="article:modified_time" content="2021-02-18T09:40:06.702Z">
<meta property="article:author" content="CDFMLR">
<meta property="article:tag" content="Math">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/rabbit.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/rabbit_192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/rabbit_180.png">
          
        
    
    <!-- title -->
    <title>用 Python 做数学建模</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
    <!--Google search varification (PRIVATE)-->
    <meta name="google-site-verification" content="MrqlpFAD8nDanw3Ypv7ZsIWHLnTdhRuLa4QhSVwxIvc" />
    <!--Google AdSense 关联 (PRIVATE)-->
    <script data-ad-client="ca-pub-1510963483941114" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/09/24/AndrewNgML/AndrewNg-MachineLearning-6-Classification/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/09/10/AndrewNgML/AndrewNg-MachineLearning-5-OctaveTutorial/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&text=用 Python 做数学建模"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&is_video=false&description=用 Python 做数学建模"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=用 Python 做数学建模&body=Check out this article: https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&name=用 Python 做数学建模&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8-Python-%E5%81%9A%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1"><span class="toc-number">1.</span> <span class="toc-text">用 Python 做数学建模</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92"><span class="toc-number">1.1.</span> <span class="toc-text">线性规划</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E8%A7%84%E5%88%92"><span class="toc-number">1.2.</span> <span class="toc-text">整数规划</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E6%B3%95%EF%BC%88%E9%9A%8F%E6%9C%BA%E5%8F%96%E6%A0%B7%E6%B3%95%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">蒙特卡洛法（随机取样法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E6%B4%BE%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.2.</span> <span class="toc-text">指派问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92"><span class="toc-number">1.3.</span> <span class="toc-text">非线性规划</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.1.</span> <span class="toc-text">非线性规划模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E7%BA%A6%E6%9D%9F%E9%97%AE%E9%A2%98%E7%9A%84-Python-%E8%A7%A3%E6%B3%95"><span class="toc-number">1.3.2.</span> <span class="toc-text">无约束问题的 Python 解法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E8%A7%A3"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">符号解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E8%A7%A3"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">数值解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%82%E5%87%BD%E6%95%B0%E7%9A%84%E9%9B%B6%E7%82%B9%E5%92%8C%E6%96%B9%E7%A8%8B%E7%BB%84%E7%9A%84%E8%A7%A3"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">求函数的零点和方程组的解</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E6%9E%81%E5%80%BC%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.3.</span> <span class="toc-text">约束极值问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%EF%BC%9Anumpy"><span class="toc-number">1.4.</span> <span class="toc-text">附：numpy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-%E5%90%91%E9%87%8F-%E7%9F%A9%E9%98%B5"><span class="toc-number">1.4.1.</span> <span class="toc-text">创建 向量&#x2F;矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E7%9A%84%E6%8B%BC%E6%8E%A5"><span class="toc-number">1.4.2.</span> <span class="toc-text">矩阵的拼接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%A7%92%E7%BA%BF%E5%85%83%E7%B4%A0%E8%B5%8B%E5%80%BC"><span class="toc-number">1.4.3.</span> <span class="toc-text">对角线元素赋值</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        用 Python 做数学建模
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">clownote</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-09-17T15:00:38.000Z" itemprop="datePublished">2019-09-17</time>
        
        (Updated: <time datetime="2021-02-18T09:40:06.702Z" itemprop="dateModified">2021-02-18</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Math/" rel="tag">Math</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="用-Python-做数学建模"><a href="#用-Python-做数学建模" class="headerlink" title="用 Python 做数学建模"></a>用 Python 做数学建模</h1><h2 id="线性规划"><a href="#线性规划" class="headerlink" title="线性规划"></a>线性规划</h2><blockquote>
<p>第三方依赖库：<code>scipy</code>。</p>
</blockquote>
<p>用 <code>scipy.optimize.linprog</code> 可以解线性规划问题：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linprog(c, A_ub=<span class="literal">None</span>, b_ub=<span class="literal">None</span>, A_eq=<span class="literal">None</span>, b_eq=<span class="literal">None</span>, bounds=<span class="literal">None</span>, method=<span class="string">&#x27;simplex&#x27;</span>, callback=<span class="literal">None</span>, options=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p>其规定的问题标准型式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Minimize:     c^T * x</span><br><span class="line">    </span><br><span class="line">Subject to:   A_ub * x &lt;&#x3D; b_ub</span><br><span class="line">              A_eq * x &#x3D;&#x3D; b_eq</span><br></pre></td></tr></table></figure>
<p>e.g. 求接下列线性规划问题：<br>$$<br>\textrm{max } z=2x_1+3x_2-5x_3,\<br>\textrm{s.t. } \left { \begin{array}{ll}<br>x_1+x_2+x_3=7\<br>2x_1-5x_2+x_3\ge10\<br>x_1+3x_2+x_3\le12\<br>x_1,x_2,x_3\ge0<br>\end{array}\right.<br>$$<br><strong>解</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> optimize</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = [-<span class="number">2</span>, -<span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line">a = [[-<span class="number">2</span>, <span class="number">5</span>, -<span class="number">1</span>], [<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>]]</span><br><span class="line">b = [-<span class="number">10</span>, <span class="number">12</span>]</span><br><span class="line">aeq = [[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]]</span><br><span class="line">beq = [<span class="number">7</span>]</span><br><span class="line">bounds = [[<span class="number">0</span>, <span class="literal">None</span>], [<span class="number">0</span>, <span class="literal">None</span>], [<span class="number">0</span>, <span class="literal">None</span>]]	<span class="comment"># (0, None) means non-negative, this is a default value</span></span><br><span class="line">result = optimize.linprog(c, a, b, aeq, beq, bounds)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>⚠️【注意】这里题目是求max，标准型是min，所以在写<code>c</code>矩阵的时候把值都写成了题目中的负；类似地， <code>&gt;=</code> 的项对应的a、b中值要取之负。然后最终结果也要取<code>fun</code>的负。</p>
</blockquote>
<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    fun: -14.571428571428571</span><br><span class="line">message: &#39;Optimization terminated successfully.&#39;</span><br><span class="line">    nit: 2</span><br><span class="line">  slack: array([3.85714286, 0.        ])</span><br><span class="line"> status: 0</span><br><span class="line">success: True</span><br><span class="line">      x: array([6.42857143, 0.57142857, 0.        ])</span><br></pre></td></tr></table></figure>
<p>最优解为$x_1=6.42857143, x_2=0.57142857, x_3=0$, 对应的最优值$z=14.571428571428571$.</p>
<p>若要取 fun、x的值，可以直接用 <code>result.fun</code> 和 <code>result.x</code>。</p>
<h2 id="整数规划"><a href="#整数规划" class="headerlink" title="整数规划"></a>整数规划</h2><p>线性整数规划问题可以转换为线性规划问题求解。</p>
<p>对于非线性的整数规划，在穷举不可为时，在一定计算量下可以考虑用 <em>蒙特卡洛法</em> 得到一个满意解。</p>
<h3 id="蒙特卡洛法（随机取样法）"><a href="#蒙特卡洛法（随机取样法）" class="headerlink" title="蒙特卡洛法（随机取样法）"></a>蒙特卡洛法（随机取样法）</h3><p>e.g. $y=x^2$、$y=12-x$ 与 $x$ 轴 在第一象限围成一个曲边三角形。设计一个随机试验，求该图像面积的近似值。</p>
<p><strong>解</strong>：    设计的随机试验思想如下：在矩形区域 <code>[0, 12] * [0, 9]</code> 上产生服从均匀分布的 <code>10^7</code> 个随机点，统计随机点落在曲边三角形的频数，则曲边三角形的面积近似为上述矩形面积乘于频率。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x = [random.random() * <span class="number">12</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10000000</span>)]</span><br><span class="line">y = [random.random() * <span class="number">9</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10000000</span>)]</span><br><span class="line"></span><br><span class="line">p = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10000000</span>):</span><br><span class="line">    <span class="keyword">if</span> x[i] &lt;= <span class="number">3</span> <span class="keyword">and</span> y[i] &lt; x[i] ** <span class="number">2</span>:</span><br><span class="line">            p += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> x[i] &gt; <span class="number">3</span> <span class="keyword">and</span> y[i] &lt; <span class="number">12</span> - x[i]:</span><br><span class="line">            p += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">area_appr = <span class="number">12</span> * <span class="number">9</span> * p / <span class="number">10</span> ** <span class="number">7</span></span><br><span class="line">print(area_appr)</span><br></pre></td></tr></table></figure>
<p>结果在 <code>49.5</code> 附近。</p>
<p>e.g. 已知非线性整数规划为：<br>$$<br>\textrm{max } z=x_1^2+x_2^2+3x_3^2+4x_4^2+2x_5^2-8x_1-2x_2-3x_3-x_4-2x_5\<br>\textrm{s.t. } \left { \begin{array}{ll}<br>0 \le x_i \le 99, i=1,…,5,\<br>x_1+x_2+x_3+x_4+x_5 \le 400\<br>x_1+2x_2+2x_3+x_4+6x_5 \le 800\<br>2x_1+x_2+6x_3 \le 200\<br>x_3+x_4+5x_5 \le 200<br>\end{array}\right.<br>$$<br>如果用枚举法，要计算 <code>100^5 = 10^10</code> 个点，计算量太大。所以考虑用蒙特卡洛法去随机计算  <code>10^6</code> 个点，得到比较满意的点：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x: <span class="built_in">list</span></span>) -&gt; int:</span></span><br><span class="line">    <span class="keyword">return</span> x[<span class="number">0</span>] ** <span class="number">2</span> + x[<span class="number">1</span>] ** <span class="number">2</span> + <span class="number">3</span> * x[<span class="number">2</span>] ** <span class="number">2</span> + <span class="number">4</span> * x[<span class="number">3</span>] ** <span class="number">2</span> + <span class="number">2</span> * x[<span class="number">4</span>] ** <span class="number">2</span> - <span class="number">8</span> * x[<span class="number">0</span>] - <span class="number">2</span> * x[<span class="number">1</span>] - <span class="number">3</span> * x[<span class="number">2</span>] - x[<span class="number">3</span>] -<span class="number">2</span> * x[<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 约束向量函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">g</span>(<span class="params">x: <span class="built_in">list</span></span>) -&gt; list:</span></span><br><span class="line">    res = []</span><br><span class="line">    res.append(<span class="built_in">sum</span>(x) - <span class="number">400</span>)</span><br><span class="line">    res.append(x[<span class="number">0</span>] + <span class="number">2</span> * x[<span class="number">1</span>] + <span class="number">2</span> * x[<span class="number">2</span>] + x[<span class="number">3</span>] + <span class="number">6</span> * x[<span class="number">4</span>] - <span class="number">800</span>)</span><br><span class="line">    res.append(<span class="number">2</span> * x[<span class="number">0</span>] + x[<span class="number">1</span>] + <span class="number">6</span> * x[<span class="number">2</span>] - <span class="number">200</span>)</span><br><span class="line">    res.append(x[<span class="number">2</span>] + x[<span class="number">3</span>] + <span class="number">5</span> * x[<span class="number">4</span>] - <span class="number">200</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">random.seed(time.time)</span><br><span class="line"></span><br><span class="line">pb = <span class="number">0</span></span><br><span class="line">xb = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span> ** <span class="number">6</span>):</span><br><span class="line">    x = [random.randint(<span class="number">0</span>, <span class="number">99</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]		<span class="comment"># 产生一行五列的区间[0, 99] 上的随机整数</span></span><br><span class="line">    rf = f(x)</span><br><span class="line">    rg = g(x)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>((a &lt; <span class="number">0</span> <span class="keyword">for</span> a <span class="keyword">in</span> rg)):		<span class="comment"># 若 rg 中所有元素都小于 0</span></span><br><span class="line">        <span class="keyword">if</span> pb &lt; rf:</span><br><span class="line">            xb = x</span><br><span class="line">            pb = rf</span><br><span class="line">            </span><br><span class="line">print(xb, pb)</span><br></pre></td></tr></table></figure>
<h3 id="指派问题"><a href="#指派问题" class="headerlink" title="指派问题"></a>指派问题</h3><blockquote>
<p>第三方依赖库：<code>numpy</code> , <code>scipy</code>。</p>
</blockquote>
<p>用 <code>scipy.optimize.linear_sum_assignment</code> 可以解指派问题(the linear sum assignment problem)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linear_sum_assignment(cost_matrix)</span><br></pre></td></tr></table></figure>
<p>注意指派矩阵 <code>cost_matrix</code> 里的元素 <code>C[i, j]</code> 的 <code>i</code> 为 <em>worker</em>，<code>j</code> 为 <em>job</em>.</p>
<blockquote>
<p>Formally, let X be a boolean matrix where $X[i,j] = 1$ iff row i is assigned to column j. Then the optimal assignment has cost<br>$$<br>\min \sum_i \sum_j C_{i,j} X_{i,j}<br>$$<br>s.t. each row is assignment to at most one column, and each column to at most one row.</p>
</blockquote>
<p>e.g. 求解下列指派问题，已知指派矩阵为<br>$$<br>\left[ \begin{array}{cc}<br>3 &amp; 8 &amp; 2 &amp; 10 &amp; 3\<br>8 &amp; 7 &amp; 2 &amp; 9 &amp; 7\<br>6 &amp; 4 &amp; 2 &amp; 7 &amp; 5\<br>8 &amp; 4 &amp; 2 &amp; 3 &amp; 5\<br>9 &amp; 10 &amp; 6 &amp; 9 &amp; 10\<br>\end{array} \right].<br>$$<br><strong>解</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> scipy <span class="keyword">import</span> optimize</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = [[<span class="number">3</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">10</span>,<span class="number">3</span>], [<span class="number">8</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">9</span>,<span class="number">7</span>], [<span class="number">6</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">5</span>], [<span class="number">8</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>], [<span class="number">9</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = np.array(c)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>optimize.linear_sum_assignment(c)</span><br><span class="line">(array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]), array([<span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>]))	<span class="comment"># 对应 x15、x23、x32、x44、x51</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c[[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>]].<span class="built_in">sum</span>()		<span class="comment"># 结果代入 cost_matrix，求得最优值</span></span><br><span class="line"><span class="number">21</span></span><br></pre></td></tr></table></figure>
<h2 id="非线性规划"><a href="#非线性规划" class="headerlink" title="非线性规划"></a>非线性规划</h2><h3 id="非线性规划模型"><a href="#非线性规划模型" class="headerlink" title="非线性规划模型"></a>非线性规划模型</h3><blockquote>
<p>第三方依赖库：<code>numpy</code> , <code>scipy</code>。</p>
</blockquote>
<p>我们之前多次使用的 <code>scipy.optimize</code> 中集成了一系列用来求规划的函数，其中当然不乏解决非线性规划的方法。例如用其中的 <code>minimize</code> 函数就可以解决很多在 Matlab 中用 <code>fmincon</code> 解的非线性规划问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minimize(fun, x0, args&#x3D;(), method&#x3D;None, jac&#x3D;None, hess&#x3D;None, hessp&#x3D;None, bounds&#x3D;None, constraints&#x3D;(), tol&#x3D;None, callback&#x3D;None, options&#x3D;None)</span><br></pre></td></tr></table></figure>
<p>常用的参数：</p>
<ul>
<li><code>fun</code>:：待求 <em>最小值</em> 的目标函数，<code>fun(x, *args) -&gt; float</code>， x 是 <code>shape (n,)</code>的 1-D array  </li>
<li><code>x0</code>：初始猜测值， <code>shape (n,)</code>的 1-D array </li>
<li><code>bounds</code>：设置参数范围/约束条件，tuple，形如 <code>((0, None), (0, None))</code></li>
<li><code>constraints</code>：<em>约束条件</em>，放一系列 dict 的 tuple，<code>(&#123;&#39;type&#39;: TYPE, &#39;fun&#39;: FUN&#125;, ...)</code><ul>
<li><code>TYPE</code>：<code>&#39;eq&#39;</code>表示 函数结果等于0 ； <code>&#39;ineq&#39;</code> 表示 表达式大于等于0</li>
<li><code>FUN</code>： 约束函数</li>
</ul>
</li>
</ul>
<p>e.g. 求下列非线性规划：<br>$$<br>\textrm{min } f(x)=x_1^2+x_2^2+x_3^2+8,\<br>\textrm{s.t. } \left { \begin{array}{ll}<br>x_1^2+x_2^2+x_3^2 \ge 0,\<br>x_1+x_2^2+x_3^2 \le 20,\<br>-x_1-x_2^2+2=0,\<br>x_2+2x_3^2=3,\<br>x_1,x_2,x_3 \ge 0.<br>\end{array}\right.<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> optimize</span><br><span class="line"></span><br><span class="line">f = <span class="keyword">lambda</span> x: x[<span class="number">0</span>] ** <span class="number">2</span> + x[<span class="number">1</span>] **<span class="number">2</span> + x[<span class="number">2</span>] ** <span class="number">2</span> + <span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Notice：eq ==; ineq &gt;=</span></span><br><span class="line">cons = (&#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;ineq&#x27;</span>, <span class="string">&#x27;fun&#x27;</span>: <span class="keyword">lambda</span> x: x[<span class="number">0</span>]**<span class="number">2</span> - x[<span class="number">1</span>] + x[<span class="number">2</span>]**<span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;ineq&#x27;</span>, <span class="string">&#x27;fun&#x27;</span>: <span class="keyword">lambda</span> x: -x[<span class="number">0</span>] - x[<span class="number">1</span>] - x[<span class="number">2</span>]**<span class="number">3</span> + <span class="number">20</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;eq&#x27;</span>, <span class="string">&#x27;fun&#x27;</span>: <span class="keyword">lambda</span> x: -x[<span class="number">0</span>] - x[<span class="number">1</span>]**<span class="number">2</span> + <span class="number">2</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;eq&#x27;</span>, <span class="string">&#x27;fun&#x27;</span>: <span class="keyword">lambda</span> x: x[<span class="number">1</span>] + <span class="number">2</span> * x[<span class="number">2</span>]**<span class="number">2</span> - <span class="number">3</span>&#125;)</span><br><span class="line"></span><br><span class="line">res = optimize.minimize(f, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), constraints=cons)</span><br><span class="line"></span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    fun: 10.651091840572583</span><br><span class="line">    jac: array([1.10433471, 2.40651834, 1.89564812])</span><br><span class="line">message: &#39;Optimization terminated successfully.&#39;</span><br><span class="line">   nfev: 86</span><br><span class="line">    nit: 15</span><br><span class="line">   njev: 15</span><br><span class="line"> status: 0</span><br><span class="line">success: True</span><br><span class="line">      x: array([0.55216734, 1.20325918, 0.94782404])</span><br></pre></td></tr></table></figure>
<p>即，求得当 $(x_1,x_2,x_3)=(0.55216734, 1.20325918, 0.94782404)$ 时，最小值$y=10.651091840572583$.</p>
<h3 id="无约束问题的-Python-解法"><a href="#无约束问题的-Python-解法" class="headerlink" title="无约束问题的 Python 解法"></a>无约束问题的 Python 解法</h3><h4 id="符号解"><a href="#符号解" class="headerlink" title="符号解"></a>符号解</h4><blockquote>
<p>第三方依赖库：<code>sympy</code>。</p>
</blockquote>
<p>e.g. 求多元函数 $f(x，y) = x^3 - y^3 + 3x^2 + 3y^2 - 9x$ 的极值</p>
<p>思路：求驻点，代入Hessian矩阵，正定则为极小值，负定极大，不定不是极值点。</p>
<p><strong>解</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">f, x, y = sympy.symbols(<span class="string">&quot;f x y&quot;</span>)</span><br><span class="line"></span><br><span class="line">f = x**<span class="number">3</span> - y**<span class="number">3</span> + <span class="number">3</span> * x**<span class="number">2</span> + <span class="number">3</span> * y**<span class="number">2</span> - <span class="number">9</span> * x</span><br><span class="line">funs = sympy.Matrix([f])</span><br><span class="line">args = sympy.Matrix([x, y])</span><br><span class="line"></span><br><span class="line">df = funs.jacobian(args)        <span class="comment"># 一阶偏导</span></span><br><span class="line">d2f = df.jacobian(args)         <span class="comment"># Hessian 矩阵</span></span><br><span class="line"></span><br><span class="line">stationaryPoints = sympy.solve(df)      <span class="comment"># 驻点</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> stationaryPoints:</span><br><span class="line">    a = d2f.subs(x, i[x]).subs(y, i[y])	<span class="comment"># 驻点处的Hessian</span></span><br><span class="line">    b = a.eigenvals(multiple=<span class="literal">True</span>)      <span class="comment"># 求Hessian矩阵的特征值</span></span><br><span class="line">    fv = f.subs(x, i[x]).subs(y, i[y])	<span class="comment"># 驻点处的函数值</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>((j &gt; <span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> b)):</span><br><span class="line">        print(<span class="string">&#x27;点(&#123;x&#125;, &#123;y&#125;)是极小值点，对应的极小值为: f(&#123;x&#125;, &#123;y&#125;) = &#123;f&#125;&#x27;</span>.<span class="built_in">format</span>(x=i[x], y=i[y], f=fv))</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">all</span>((j &lt; <span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> b)):</span><br><span class="line">        print(<span class="string">&#x27;点(&#123;x&#125;, &#123;y&#125;)是极大值点，对应的极大值为: f(&#123;x&#125;, &#123;y&#125;) = &#123;f&#125;&#x27;</span>.<span class="built_in">format</span>(x=i[x], y=i[y], f=fv))</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">any</span>((j &lt; <span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> b)) <span class="keyword">and</span> <span class="built_in">any</span>((j &gt; <span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> b)):</span><br><span class="line">        print(<span class="string">&#x27;点(&#123;x&#125;, &#123;y&#125;)不是极值点&#x27;</span>.<span class="built_in">format</span>(x=i[x], y=i[y]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&#x27;无法判断点(&#123;x&#125;, &#123;y&#125;)是否为极值点&#x27;</span>.<span class="built_in">format</span>(x=i[x], y=i[y]))</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">点(-3, 0)不是极值点</span><br><span class="line">点(-3, 2)是极大值点，对应的极大值为: f(-3, 2) &#x3D; 31</span><br><span class="line">点(1, 0)是极小值点，对应的极小值为: f(1, 0) &#x3D; -5</span><br><span class="line">点(1, 2)不是极值点</span><br></pre></td></tr></table></figure>


<h4 id="数值解"><a href="#数值解" class="headerlink" title="数值解"></a>数值解</h4><blockquote>
<p>第三方依赖库：<code>numpy</code> , <code>scipy</code>。</p>
</blockquote>
<p>利用 Python 求无约束极值的数值解与我们在非线性规划模型中的操作类似，我们依然使用 <code>minimize</code> 函数求解，不过这次连 constraints 都不用了。</p>
<p>e.g. 求多元函数 $f(x，y) = x^3 - y^3 + 3x^2 + 3y^2 - 9x$ 的最值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from scipy import optimize</span><br><span class="line"></span><br><span class="line">f &#x3D; lambda x: x[0]**3 - x[1]**3 + 3 * x[0]**2 + 3 * x[1]**2 - 9 * x[0]</span><br><span class="line"></span><br><span class="line">resMin &#x3D; optimize.minimize(f, (0, 0))		# 求最小值</span><br><span class="line">resMax &#x3D; optimize.minimize(lambda x: -f(x), (0, 0))		# 求最大值</span><br><span class="line"></span><br><span class="line">print(&quot;最小值：\n&quot;)</span><br><span class="line">print(resMin)</span><br><span class="line">print(&quot;最大值：\n&quot;)</span><br><span class="line">print(resMax)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">极小值：</span><br><span class="line"></span><br><span class="line">      fun: -5.0</span><br><span class="line"> hess_inv: array([[8.34028325e-02, 3.27721596e-09],</span><br><span class="line">       [3.27721596e-09, 1.00000000e+00]])</span><br><span class="line">      jac: array([1.1920929e-07, 0.0000000e+00])</span><br><span class="line">  message: &#39;Optimization terminated successfully.&#39;</span><br><span class="line">     nfev: 20</span><br><span class="line">      nit: 4</span><br><span class="line">     njev: 5</span><br><span class="line">   status: 0</span><br><span class="line">  success: True</span><br><span class="line">        x: array([ 1.00000000e+00, -5.40966234e-09])</span><br><span class="line">极大值：</span><br><span class="line"></span><br><span class="line">      fun: -30.99999999999847</span><br><span class="line"> hess_inv: array([[0.08280865, 0.00036445],</span><br><span class="line">       [0.00036445, 0.16672048]])</span><br><span class="line">      jac: array([ 9.53674316e-07, -4.29153442e-06])</span><br><span class="line">  message: &#39;Optimization terminated successfully.&#39;</span><br><span class="line">     nfev: 172</span><br><span class="line">      nit: 11</span><br><span class="line">     njev: 43</span><br><span class="line">   status: 0</span><br><span class="line">  success: True</span><br><span class="line">        x: array([-2.99999994,  1.99999929])</span><br></pre></td></tr></table></figure>

<h4 id="求函数的零点和方程组的解"><a href="#求函数的零点和方程组的解" class="headerlink" title="求函数的零点和方程组的解"></a>求函数的零点和方程组的解</h4><blockquote>
<p>第三方依赖库：<code>sympy</code>。</p>
</blockquote>
<p>使用 <code>sympy.solve</code> 函数可以求出方程/方程组的符号解，得到的每个根可以调用其 <code>evalf</code> 方法转化为近似的数值。</p>
<ol>
<li>求多项式 $f(x)=x^3-x^2+2x-3$ 的零点</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sympy</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = sympy.Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = sympy.solve(x**<span class="number">3</span> - x**<span class="number">2</span> + <span class="number">2</span> * x -<span class="number">3</span>)		<span class="comment"># 求符号解</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line">[<span class="number">1</span>/<span class="number">3</span> + (-<span class="number">1</span>/<span class="number">2</span> - sqrt(<span class="number">3</span>)*I/<span class="number">2</span>)*(<span class="number">65</span>/<span class="number">54</span> + <span class="number">5</span>*sqrt(<span class="number">21</span>)/<span class="number">18</span>)**(<span class="number">1</span>/<span class="number">3</span>) - <span class="number">5</span>/(<span class="number">9</span>*(-<span class="number">1</span>/<span class="number">2</span> - sqrt(<span class="number">3</span>)*I/<span class="number">2</span>)*(<span class="number">65</span>/<span class="number">54</span> + <span class="number">5</span>*sqrt(<span class="number">21</span>)/<span class="number">18</span>)**(<span class="number">1</span>/<span class="number">3</span>)), <span class="number">1</span>/<span class="number">3</span> - <span class="number">5</span>/(<span class="number">9</span>*(-<span class="number">1</span>/<span class="number">2</span> + sqrt(<span class="number">3</span>)*I/<span class="number">2</span>)*(<span class="number">65</span>/<span class="number">54</span> + <span class="number">5</span>*sqrt(<span class="number">21</span>)/<span class="number">18</span>)**(<span class="number">1</span>/<span class="number">3</span>)) + (-<span class="number">1</span>/<span class="number">2</span> + sqrt(<span class="number">3</span>)*I/<span class="number">2</span>)*(<span class="number">65</span>/<span class="number">54</span> + <span class="number">5</span>*sqrt(<span class="number">21</span>)/<span class="number">18</span>)**(<span class="number">1</span>/<span class="number">3</span>), -<span class="number">5</span>/(<span class="number">9</span>*(<span class="number">65</span>/<span class="number">54</span> + <span class="number">5</span>*sqrt(<span class="number">21</span>)/<span class="number">18</span>)**(<span class="number">1</span>/<span class="number">3</span>)) + <span class="number">1</span>/<span class="number">3</span> + (<span class="number">65</span>/<span class="number">54</span> + <span class="number">5</span>*sqrt(<span class="number">21</span>)/<span class="number">18</span>)**(<span class="number">1</span>/<span class="number">3</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line"><span class="meta">... </span>    print(i.evalf())		<span class="comment"># 近似数值</span></span><br><span class="line"><span class="meta">... </span></span><br><span class="line">-<span class="number">0.137841101825493</span> - <span class="number">1.52731225088663</span>*I</span><br><span class="line">-<span class="number">0.137841101825493</span> + <span class="number">1.52731225088663</span>*I</span><br><span class="line"><span class="number">1.27568220365098</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ol start="2">
<li>求如下方程组的解</li>
</ol>
<p>$$<br>\left{\begin{array}{l}<br>x^2+y-6=0\<br>y^2+x-6=0\<br>\end{array}\right.<br>$$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sympy</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y = sympy.symbols(<span class="string">&#x27;x y&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = sympy.solve((x**<span class="number">2</span>+y-<span class="number">6</span>, y**<span class="number">2</span>+x-<span class="number">6</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s</span><br><span class="line">[&#123;x: -<span class="number">3</span>, y: -<span class="number">3</span>&#125;, &#123;x: <span class="number">2</span>, y: <span class="number">2</span>&#125;, &#123;x: <span class="number">6</span> - (<span class="number">1</span>/<span class="number">2</span> - sqrt(<span class="number">21</span>)/<span class="number">2</span>)**<span class="number">2</span>, y: <span class="number">1</span>/<span class="number">2</span> - sqrt(<span class="number">21</span>)/<span class="number">2</span>&#125;, &#123;x: <span class="number">6</span> - (<span class="number">1</span>/<span class="number">2</span> + sqrt(<span class="number">21</span>)/<span class="number">2</span>)**<span class="number">2</span>, y: <span class="number">1</span>/<span class="number">2</span> + sqrt(<span class="number">21</span>)/<span class="number">2</span>&#125;]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line"><span class="meta">... </span>    print(<span class="string">&#x27;(&#123;x&#125;, &#123;y&#125;)&#x27;</span>.<span class="built_in">format</span>(x=i[x].evalf(), y=i[y].evalf()))</span><br><span class="line"><span class="meta">... </span></span><br><span class="line">(-<span class="number">3.00000000000000</span>, -<span class="number">3.00000000000000</span>)</span><br><span class="line">(<span class="number">2.00000000000000</span>, <span class="number">2.00000000000000</span>)</span><br><span class="line">(<span class="number">2.79128784747792</span>, -<span class="number">1.79128784747792</span>)</span><br><span class="line">(-<span class="number">1.79128784747792</span>, <span class="number">2.79128784747792</span>)</span><br></pre></td></tr></table></figure>
<h3 id="约束极值问题"><a href="#约束极值问题" class="headerlink" title="约束极值问题"></a>约束极值问题</h3><p>参考上文 “无约束问题的 Python 解法”。</p>
<p>……</p>
<p><strong>未完但不用待续了，应该没有后续了，我对用 python 做数学建模以及数学建模都失去兴趣了。</strong></p>
<h2 id="附：numpy"><a href="#附：numpy" class="headerlink" title="附：numpy"></a>附：numpy</h2><p>推荐一份质量比较高的 numpy 中文文档：<a target="_blank" rel="noopener" href="https://www.numpy.org.cn/index.html">https://www.numpy.org.cn/index.html</a>.</p>
<h3 id="创建-向量-矩阵"><a href="#创建-向量-矩阵" class="headerlink" title="创建 向量/矩阵"></a>创建 向量/矩阵</h3><p>用 <code>np.array()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line">array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">       [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br></pre></td></tr></table></figure>
<h3 id="矩阵的拼接"><a href="#矩阵的拼接" class="headerlink" title="矩阵的拼接"></a>矩阵的拼接</h3><ul>
<li>列合并/扩展：<code>np.column_stack()</code></li>
<li>行合并/扩展：<code>np.row_stack()</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A = np.array([[<span class="number">1</span>,<span class="number">1</span>], [<span class="number">2</span>,<span class="number">2</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>B = np.array([[<span class="number">3</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">4</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A</span><br><span class="line">array([[<span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">2</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>B</span><br><span class="line">array([[<span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">4</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.column_stack((A, B))		<span class="comment"># 行</span></span><br><span class="line">array([[<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.row_stack((A, B))			<span class="comment"># 列</span></span><br><span class="line">array([[<span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">       [<span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">       [<span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">4</span>]])</span><br></pre></td></tr></table></figure>
<h3 id="对角线元素赋值"><a href="#对角线元素赋值" class="headerlink" title="对角线元素赋值"></a>对角线元素赋值</h3><p>比如说我们有一个 <code>np.array X</code>，我想对角线的所有值设置为0，可以用 <code>np.fill_diagonal(X, [0, 0, 0, ...])</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; D &#x3D; np.zeros([3, 3])</span><br><span class="line">&gt;&gt;&gt; np.fill_diagonal(D, [1, 2, 3])</span><br><span class="line">&gt;&gt;&gt; D</span><br><span class="line">array([[1., 0., 0.],</span><br><span class="line">       [0., 2., 0.],</span><br><span class="line">       [0., 0., 3.]])</span><br></pre></td></tr></table></figure>
  </div>
</article>
<!--Disqus-->


<!--Livere-->

    <div class="blog-post-comments">
        <div id="lv-container" data-id="city" data-uid="MTAyMC80NjEzMi8yMjY0Mw==">
            <noscript>不启用 JavaScript 支持的人是看不到可爱的评论区的。😥</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8-Python-%E5%81%9A%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1"><span class="toc-number">1.</span> <span class="toc-text">用 Python 做数学建模</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92"><span class="toc-number">1.1.</span> <span class="toc-text">线性规划</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E6%95%B0%E8%A7%84%E5%88%92"><span class="toc-number">1.2.</span> <span class="toc-text">整数规划</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E6%B3%95%EF%BC%88%E9%9A%8F%E6%9C%BA%E5%8F%96%E6%A0%B7%E6%B3%95%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">蒙特卡洛法（随机取样法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E6%B4%BE%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.2.</span> <span class="toc-text">指派问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92"><span class="toc-number">1.3.</span> <span class="toc-text">非线性规划</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.1.</span> <span class="toc-text">非线性规划模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E7%BA%A6%E6%9D%9F%E9%97%AE%E9%A2%98%E7%9A%84-Python-%E8%A7%A3%E6%B3%95"><span class="toc-number">1.3.2.</span> <span class="toc-text">无约束问题的 Python 解法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E8%A7%A3"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">符号解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E8%A7%A3"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">数值解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%82%E5%87%BD%E6%95%B0%E7%9A%84%E9%9B%B6%E7%82%B9%E5%92%8C%E6%96%B9%E7%A8%8B%E7%BB%84%E7%9A%84%E8%A7%A3"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">求函数的零点和方程组的解</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E6%9E%81%E5%80%BC%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.3.</span> <span class="toc-text">约束极值问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%EF%BC%9Anumpy"><span class="toc-number">1.4.</span> <span class="toc-text">附：numpy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-%E5%90%91%E9%87%8F-%E7%9F%A9%E9%98%B5"><span class="toc-number">1.4.1.</span> <span class="toc-text">创建 向量&#x2F;矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E7%9A%84%E6%8B%BC%E6%8E%A5"><span class="toc-number">1.4.2.</span> <span class="toc-text">矩阵的拼接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%A7%92%E7%BA%BF%E5%85%83%E7%B4%A0%E8%B5%8B%E5%80%BC"><span class="toc-number">1.4.3.</span> <span class="toc-text">对角线元素赋值</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&text=用 Python 做数学建模"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&is_video=false&description=用 Python 做数学建模"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=用 Python 做数学建模&body=Check out this article: https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&title=用 Python 做数学建模"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://clownote.github.io/2019/09/17/blog/MathematicalModelingWithPython/&name=用 Python 做数学建模&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 CDFMLR
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-146911386-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?9a0d2e6fde93dad496ac79f04f3aba97";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


<!--Livere Comments-->

    <script type="text/javascript">
      (function (d, s) {
        var j, e = d.getElementsByTagName(s)[0];

        if (typeof LivereTower === 'function') { return; }

        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;

        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>

</body>
</html>
