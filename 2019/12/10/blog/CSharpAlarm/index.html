<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="利用 C# 语言实现跨平台小闹钟前言学校的课程要求做一个 C# 小闹钟程序设计，具体要求如下：  做一个小闹钟窗体应用程序。 具备实时显示数字时钟的功能，方便使用者获取当前的时间。 具备实时绘制表盘时钟的功能，根据当前时间再来绘制秒针、分针和时针。 具备整点报时的功能，当处于整点时，系统进行报时。 具备定点报时的功能，根据使用者的设定，进行报时。 把使用者设置的报时时间，记录在文本文件中，系统在启">
<meta property="og:type" content="article">
<meta property="og:title" content="利用 C# 语言实现跨平台小闹钟">
<meta property="og:url" content="https://clownote.github.io/2019/12/10/blog/CSharpAlarm/index.html">
<meta property="og:site_name" content="clownote">
<meta property="og:description" content="利用 C# 语言实现跨平台小闹钟前言学校的课程要求做一个 C# 小闹钟程序设计，具体要求如下：  做一个小闹钟窗体应用程序。 具备实时显示数字时钟的功能，方便使用者获取当前的时间。 具备实时绘制表盘时钟的功能，根据当前时间再来绘制秒针、分针和时针。 具备整点报时的功能，当处于整点时，系统进行报时。 具备定点报时的功能，根据使用者的设定，进行报时。 把使用者设置的报时时间，记录在文本文件中，系统在启">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1g9qnn9cnd8j31d50u0qft.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1g9qes7ga8nj30ea0ehmxj.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1g9qtdimzaxj31f20u0wop.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1g9vdl50y0qj312o0u0gqs.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1g9qey1safbj305b05bmx7.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1g9vdfrwji1j30m40d8dg5.jpg">
<meta property="article:published_time" content="2019-12-10T12:59:21.000Z">
<meta property="article:modified_time" content="2021-02-27T13:08:04.459Z">
<meta property="article:author" content="CDFMLR">
<meta property="article:tag" content="School">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/006tNbRwly1g9qnn9cnd8j31d50u0qft.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/rabbit.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/rabbit_192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/rabbit_180.png">
          
        
    
    <!-- title -->
    <title>利用 C# 语言实现跨平台小闹钟</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
    <!--Google search varification (PRIVATE)-->
    <meta name="google-site-verification" content="MrqlpFAD8nDanw3Ypv7ZsIWHLnTdhRuLa4QhSVwxIvc" />
    <!--Google AdSense 关联 (PRIVATE)-->
    <script data-ad-client="ca-pub-1510963483941114" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<meta name="generator" content="Hexo 5.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/12/17/AndrewNgML/AndrewNg-MachineLearning-17-LargeScaleMachineLearning/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/12/05/AndrewNgML/AndrewNg-MachineLearning-16-RecommenderSystems/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&text=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&is_video=false&description=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=利用 C# 语言实现跨平台小闹钟&body=Check out this article: https://clownote.github.io/2019/12/10/blog/CSharpAlarm/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&name=利用 C# 语言实现跨平台小闹钟&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-C-%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%B0%8F%E9%97%B9%E9%92%9F"><span class="toc-number">1.</span> <span class="toc-text">利用 C# 语言实现跨平台小闹钟</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.2.</span> <span class="toc-text">设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.</span> <span class="toc-text">实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%86%E7%9B%98%E6%97%B6%E9%92%9F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.1.</span> <span class="toc-text">圆盘时钟的实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E7%9B%98"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">表盘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E9%92%88"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">指针</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.2.</span> <span class="toc-text">闹钟功能实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">闹钟、数据库模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E7%9B%B8%E5%85%B3%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">闹钟相关的页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E6%9D%A1%E7%9B%AE%E7%9A%84CRUD"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">闹钟条目的CRUD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E6%8F%90%E9%86%92"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">闹钟提醒</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%A6%E4%B8%80%E7%A7%8D%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.5.</span> <span class="toc-text">另一种实现</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        利用 C# 语言实现跨平台小闹钟
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">clownote</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-12-10T12:59:21.000Z" itemprop="datePublished">2019-12-10</time>
        
        (Updated: <time datetime="2021-02-27T13:08:04.459Z" itemprop="dateModified">2021-02-27</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/School/" rel="tag">School</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="利用-C-语言实现跨平台小闹钟"><a href="#利用-C-语言实现跨平台小闹钟" class="headerlink" title="利用 C# 语言实现跨平台小闹钟"></a>利用 C# 语言实现跨平台小闹钟</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>学校的课程要求做一个 C# 小闹钟程序设计，具体要求如下：</p>
<ol>
<li>做一个小闹钟窗体应用程序。</li>
<li>具备实时显示数字时钟的功能，方便使用者获取当前的时间。</li>
<li>具备实时绘制表盘时钟的功能，根据当前时间再来绘制秒针、分针和时针。</li>
<li>具备整点报时的功能，当处于整点时，系统进行报时。</li>
<li>具备定点报时的功能，根据使用者的设定，进行报时。</li>
<li>把使用者设置的报时时间，记录在文本文件中，系统在启动时，自动加载该文本文件以便获取定点报时的时间。</li>
<li>系统最小化时，缩小为系统托盘。</li>
</ol>
<p>这个东西不难，就是最简单的 App 开发嘛，但要求用 C# 做 Windows 窗体就很烦。由于我不使用 Windows 系统，所以拿到题目，首先的想法就是<strong>跨平台</strong>，我希望在 Mac 上完成开发，然后直接打包发布到 Windows 平台。</p>
<p>以前看过好几个跨平台的开源的 UI 实现项目都是 C# 写的，比如 Pathos: Nethack Codex 用的 Invention。但因为我之前甚至从没用过 C#，所以对于它们具体的实现不是很了解。经过一阵 Google，我找到了 Microsoft 自家做的跨平台方案——Xamarin。</p>
<p>emmmm，Xamarin 还分好几个部分，Xamarin.Forms，Xamarin.Mac 什么的。其中，Xamarin.Forms 可以一套 UI 代码生成 Android、iOS、UWP(支持不完整，还是预览版)。这个框架下 Android、iOS 可以在 Mac 上用 Visual Studio for Mac 来开发并且生成，UWP 只能在 Windows 下生成。</p>
<p>这个东西感觉还不错，看文档里生成出来的 UI 效果挺好看的，代码也比较简单（相较于原生 Android 开发），所以我决定用这个 Xamarin.Forms 先在 Mac 下完成这个小闹钟的开发，然后借一台 Windows 电脑来生成 UWP。</p>
<p>决定了框架，然后就是 C# 基础语法和 Xamarin.Forms 的学习了。这两个东西微软都有详细的、针对各种不同技术水平的开发者的入门教程，顺着看一遍，把例子写一下也就足够完成这次的小闹钟任务了。</p>
<p>接下来就进入跨平台小闹钟开发的过程了。</p>
<h2 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h2><p>我们首先思考我们期望的 App 使用场景：用户点击打开 App，屏幕上显示出一个圆盘时钟，然后，可以从导航条（iOS 的习惯是底部，Android 和 UWP 为顶部）切换到一个现实这闹钟条目到界面，用户可以在这里点开一条闹钟条目进行编辑，或着添加新的闹钟条目。</p>
<p>iOS 自带的 “时钟” App 给了我们很好的参考（由于它没有圆盘时钟功能，我截了一张“就寝”界面替代😓）：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1g9qnn9cnd8j31d50u0qft.jpg" alt="IMG_1573"></p>
<p>在我们的设计中，小闹钟 App 可以分为这样几个页面：</p>
<ul>
<li>🕤时钟页：显示一个圆盘时钟，展示当前时间；</li>
<li>⏰闹钟页：显示当前设定的所有闹钟条目，可以点开编辑、新建闹钟条目；</li>
<li>🧾详情页：新建、编辑一条闹钟的时间、注释的页面，并有保存、删除的功能。</li>
</ul>
<p>具体到 Xamarin.Forms 中，这些 Pages 如下图所示：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1g9qes7ga8nj30ea0ehmxj.jpg" alt="MyClockPagesDiagram"></p>
<p>然后，我们还需要设计另外一个重要的部分，一条“闹钟”的表示和储存。</p>
<p>可以考虑用一个 <code>AlarmItem</code> 类来代表一条闹钟，这个类要具有 唯一ID、时间、是否打开、注释 这几个属性。</p>
<p>在 Xamarin 中，我们可以很方便地引入 SQLite 储存这个对象，只需要写一个 <code>Database</code> 类，简单封装一下 CRUD，方便后续使用。</p>
<p>接下来就要开始代码实现了，先贴出最后成品截图，iOS上的效果：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1g9qtdimzaxj31f20u0wop.jpg" alt="IMG_1576"></p>
<p>UWP 的效果：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1g9vdl50y0qj312o0u0gqs.jpg" alt="IMG_1600"></p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>整个 App 的基础大概有了，现在考虑一些实现的细节。</p>
<p>（在这里我只列出关键的或者任何我认为有意思的代码片段，完整代码见 <a target="_blank" rel="noopener" href="https://github.com/cdfmlr/MyClock">GitHub</a>）</p>
<h3 id="圆盘时钟的实现"><a href="#圆盘时钟的实现" class="headerlink" title="圆盘时钟的实现"></a>圆盘时钟的实现</h3><p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1g9qey1safbj305b05bmx7.jpg" alt="屏幕快照 2019-12-09 13.36.51"></p>
<p>绘制一个如上图所示的圆盘时钟，需要实时的矢量图绘制。Xamarin.Forms 不具有内置的矢量图形系统，但有一个 BoxView 可帮助进行补偿。<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/dotnet/api/xamarin.forms.boxview">BoxView</a>  呈现指定的宽度、 高度和颜色的一个简单的矩形。参照微软的文档，我们可以按下面的思路实现一个时钟：</p>
<h4 id="表盘"><a href="#表盘" class="headerlink" title="表盘"></a>表盘</h4><p>对于表盘，通过简单的数学计算，就可以得到从12点开始的表盘上 60 个均匀分布的刻度点的位置坐标。在一个可以指定位置的 AbsoluteLayout 中。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create the tick marks</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; tickMarks.Length; i++)</span><br><span class="line">&#123;</span><br><span class="line">	tickMarks[i] = <span class="keyword">new</span> BoxView &#123; Color = Color.Black &#125;;</span><br><span class="line">	absoluteLayout.Children.Add(tickMarks[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面我们生成了 60 个大小相同的正方形 BoxView，现将模5的点稍微加大，然后把它们放置到指定的位置，针对不同位置的正方形做一个使其正对中心的旋转，表盘就完成了。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Size and position a tickMark</span></span><br><span class="line"><span class="built_in">double</span> size = radius / (index % <span class="number">5</span> == <span class="number">0</span> ? <span class="number">15</span> : <span class="number">30</span>);</span><br><span class="line"><span class="built_in">double</span> radians = index * <span class="number">2</span> * Math.PI / tickMarks.Length;</span><br><span class="line"><span class="built_in">double</span> x = center.X + radius * Math.Sin(radians) - size / <span class="number">2</span>;</span><br><span class="line"><span class="built_in">double</span> y = center.Y - radius * Math.Cos(radians) - size / <span class="number">2</span>;</span><br><span class="line">AbsoluteLayout.SetLayoutBounds(tickMarks[index], <span class="keyword">new</span> Rectangle(x, y, size, size));</span><br><span class="line">tickMarks[index].Rotation = <span class="number">180</span> * radians / Math.PI;</span><br></pre></td></tr></table></figure>
<h4 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h4><p>接下来是指针，先在之前的 AbsoluteLayout 中实例化三个代表时分秒针的 BoxView：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">AbsoluteLayout</span> <span class="attr">x:Name</span>=<span class="string">&quot;absoluteLayout&quot;</span> <span class="attr">SizeChanged</span>=<span class="string">&quot;OnAbsoluteLayoutSizeChanged&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">BoxView</span> <span class="attr">x:Name</span>=<span class="string">&quot;hourHand&quot;</span> <span class="attr">Color</span>=<span class="string">&quot;Black&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">BoxView</span> <span class="attr">x:Name</span>=<span class="string">&quot;minuteHand&quot;</span> <span class="attr">Color</span>=<span class="string">&quot;Black&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">BoxView</span> <span class="attr">x:Name</span>=<span class="string">&quot;secondHand&quot;</span> <span class="attr">Color</span>=<span class="string">&quot;Black&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">AbsoluteLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>写一个 <code>HandParams</code> 来指定三个时针的形状：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> HandParams</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HandParams</span>(<span class="params"><span class="built_in">double</span> width, <span class="built_in">double</span> height, <span class="built_in">double</span> offset</span>) : <span class="title">this</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Width = width;</span><br><span class="line">        Height = height;</span><br><span class="line">        Offset = offset;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Width &#123; <span class="keyword">private</span> <span class="keyword">set</span>; <span class="keyword">get</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Height &#123; <span class="keyword">private</span> <span class="keyword">set</span>; <span class="keyword">get</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Offset &#123; <span class="keyword">private</span> <span class="keyword">set</span>; <span class="keyword">get</span>; &#125;	<span class="comment">// 旋转中心</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">readonly</span> HandParams secondParams = <span class="keyword">new</span> HandParams(<span class="number">0.02</span>, <span class="number">1.1</span>, <span class="number">0.85</span>);</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">readonly</span> HandParams minuteParams = <span class="keyword">new</span> HandParams(<span class="number">0.05</span>, <span class="number">0.8</span>, <span class="number">0.9</span>);</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">readonly</span> HandParams hourParams = <span class="keyword">new</span> HandParams(<span class="number">0.125</span>, <span class="number">0.65</span>, <span class="number">0.9</span>);</span><br></pre></td></tr></table></figure>
<p>然后，写一个 <code>LayoutHand</code> 来把指针放到合适的地方：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LayoutHand</span>(<span class="params">BoxView boxView, HandParams handParams, Point center, <span class="built_in">double</span> radius</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">double</span> width = handParams.Width * radius;</span><br><span class="line">    <span class="built_in">double</span> height = handParams.Height * radius;</span><br><span class="line">    <span class="built_in">double</span> offset = handParams.Offset;</span><br><span class="line"></span><br><span class="line">    AbsoluteLayout.SetLayoutBounds(boxView,</span><br><span class="line">                                   <span class="keyword">new</span> Rectangle(center.X - <span class="number">0.5</span> * width,</span><br><span class="line">                                                 center.Y - offset * height,</span><br><span class="line">                                                 width, height));</span><br><span class="line">    boxView.AnchorY = handParams.Offset;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LayoutHand(secondHand, secondParams, center, radius);</span><br><span class="line">LayoutHand(minuteHand, minuteParams, center, radius);</span><br><span class="line">LayoutHand(hourHand, hourParams, center, radius);</span><br></pre></td></tr></table></figure>
<p>在时间流动时，旋转指针，为了营造一种真实的感觉，我们可以用一个动画效果让秒钟的移动有真实的摆动感，但这个动画需要我们 Timer Tick 的频率高一点：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ClockPage</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    InitializeComponent();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    Device.StartTimer(TimeSpan.FromSeconds(<span class="number">1.0</span> / <span class="number">60</span>), OnTimerTick);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">bool</span> <span class="title">OnTimerTick</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DateTime dateTime = DateTime.Now;</span><br><span class="line">    hourHand.Rotation = <span class="number">30</span> * (dateTime.Hour % <span class="number">12</span>) + <span class="number">0.5</span> * dateTime.Minute;</span><br><span class="line">    minuteHand.Rotation = <span class="number">6</span> * dateTime.Minute + <span class="number">0.1</span> * dateTime.Second;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">double</span> t = dateTime.Millisecond / <span class="number">1000.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (t &lt; <span class="number">0.5</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        t = <span class="number">0.5</span> * Easing.SpringIn.Ease(t / <span class="number">0.5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        t = <span class="number">0.5</span> * (<span class="number">1</span> + Easing.SpringOut.Ease((t - <span class="number">0.5</span>) / <span class="number">0.5</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    secondHand.Rotation = <span class="number">6</span> * (dateTime.Second + t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>至此，一个圆盘时钟就完成了。</p>
<h3 id="闹钟功能实现"><a href="#闹钟功能实现" class="headerlink" title="闹钟功能实现"></a>闹钟功能实现</h3><h4 id="闹钟、数据库模块"><a href="#闹钟、数据库模块" class="headerlink" title="闹钟、数据库模块"></a>闹钟、数据库模块</h4><p>我们将使用 <code>SQLite.NET</code> 将数据库操作合并到应用程序。</p>
<p>首先要做的是使用 Visual Studio 中的 NuGet 包管理器将 NuGet 包添加到项目。这里我们需要添加的包叫做 <code>sqlite-net-pcl</code> （详细操作参考官方文档：<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/xamarin/get-started/quickstarts/database">将数据存储在本地 SQLite.NET 数据库中</a>），添加完成后我们就可以将数据存储在本地 SQLite.NET 数据库中了。</p>
<p>接下来我们实现设计中提到的 <code>AlamItem</code> 类来表示一条闹钟：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> SQLite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">MyClock</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AlarmItem</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">PrimaryKey, AutoIncrement</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> TimeSpan Time &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> Work &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Note &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">return</span> Time.ToString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里使用了 <code>PrimaryKey</code> 和 <code>AutoIncrement</code> 特性标记 <code>ID</code> 属性，以确保 SQLite.NET 数据库中的每个 <code>AlarmItem</code> 实例都具有 SQLite.NET 提供的唯一 id。</p>
<p>然后，创建一个 <code>Database</code> 类，包含用于创建数据库、从中读取数据、向其中写入数据以及从中删除数据的代码：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> SQLite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">MyClock</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Database</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">readonly</span> SQLiteAsyncConnection _database;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Database</span>(<span class="params"><span class="built_in">string</span> dbPath</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            _database = <span class="keyword">new</span> SQLiteAsyncConnection(dbPath);</span><br><span class="line">            _database.CreateTableAsync&lt;AlarmItem&gt;().Wait();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Task&lt;List&lt;AlarmItem&gt;&gt; GetAllAlarmItemsAsync()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> _database.Table&lt;AlarmItem&gt;().ToListAsync();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task&lt;<span class="built_in">int</span>&gt; <span class="title">SaveAlarmItemAsync</span>(<span class="params">AlarmItem alarmItem</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">if</span> (alarmItem.ID != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> _database.UpdateAsync(alarmItem);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> _database.InsertAsync(alarmItem);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task&lt;<span class="built_in">int</span>&gt; <span class="title">DeleteAlarmItemAsync</span>(<span class="params">AlarmItem alarmItem</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">return</span> _database.DeleteAsync(alarmItem);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们使用的全是将数据库操作移动到后台线程的异步 SQLite.NET API。 此外，<code>Database</code>构造函数将数据库文件的路径作为参数。</p>
<h4 id="闹钟相关的页面"><a href="#闹钟相关的页面" class="headerlink" title="闹钟相关的页面"></a>闹钟相关的页面</h4><p>接下来我们考虑先把和闹钟的CRUD相关的 <code>AlarmPage</code> 和 <code>AlarmEditPage</code> 页面实现。</p>
<p>首先是 <code>AlarmPage</code>，这个界面将罗列所有的已有闹钟条目，并且可以添加新的条目：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ContentPage</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xamarin.com/schemas/2014/forms&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">xmlns:x</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2009/xaml&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">x:Class</span>=<span class="string">&quot;MyClock.AlarmPage&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">Title</span>=<span class="string">&quot;闹钟&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ContentPage.ToolbarItems</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ToolbarItem</span> <span class="attr">Text</span>=<span class="string">&quot;+&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">IconImageSource</span>=<span class="string">&quot;add.png&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">Clicked</span>=<span class="string">&quot;OnAlarmItemAddClicked&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ContentPage.ToolbarItems</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">StackLayout</span> <span class="attr">Margin</span>=<span class="string">&quot;20&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ListView</span> <span class="attr">x:Name</span>=<span class="string">&quot;alarmListView&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">ItemSelected</span>=<span class="string">&quot;OnAlarmItemSelected&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ListView.ItemTemplate</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">TextCell</span> <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding TimeString&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">Detail</span>=<span class="string">&quot;&#123;Binding Note&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ListView.ItemTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ListView</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Text</span>=<span class="string">&quot;添加&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Clicked</span>=<span class="string">&quot;OnAlarmItemAddClicked&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">StackLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ContentPage</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里我在标题栏里写了一个添加新条目的 “<code>+</code>” 按钮，但由于调试中发现，它虽然在 Android、iOS 中都能很好的呈现，但在 UWP 里不可见（虽然把鼠标移到那里稍微移动屏幕后可以看到也可以点击到它），用户体验很差，所以就在 ListView 下面加了一个很显眼、也几乎不可能出意外的 “<code>添加</code>” Button。</p>
<p>当用户点击 ListView 里的闹钟条目 或者 添加新条目 时，将转到 <code>AlarmEditPage</code> 完成闹钟条目的查看、编辑、保存或删除：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">async</span> <span class="keyword">void</span> <span class="title">OnAlarmItemAddClicked</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">await</span> Navigation.PushAsync(<span class="keyword">new</span> AlarmEditPage</span><br><span class="line">	&#123;</span><br><span class="line">		BindingContext = <span class="keyword">new</span> AlarmItem()</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">async</span> <span class="keyword">void</span> <span class="title">OnAlarmItemSelected</span>(<span class="params"><span class="built_in">object</span> sender, SelectedItemChangedEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (e.SelectedItem != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> Navigation.PushAsync(<span class="keyword">new</span> AlarmEditPage</span><br><span class="line">		&#123;</span><br><span class="line">			BindingContext = e.SelectedItem <span class="keyword">as</span> AlarmItem</span><br><span class="line">		&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>AlarmEditPage</code> 的界面设计如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ContentPage</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xamarin.com/schemas/2014/forms&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">xmlns:x</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2009/xaml&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">x:Class</span>=<span class="string">&quot;MyClock.AlarmEditPage&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">Title</span>=<span class="string">&quot;设置闹钟&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">StackLayout</span> <span class="attr">Margin</span>=<span class="string">&quot;20, 35, 20, 20&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Label</span> <span class="attr">Text</span>=<span class="string">&quot;时间:&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TimePicker</span> <span class="attr">Time</span>=<span class="string">&quot;&#123;Binding Time&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">Format</span>=<span class="string">&quot;T&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">StackLayout</span> <span class="attr">Orientation</span>=<span class="string">&quot;Vertical&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Label</span> <span class="attr">Text</span>=<span class="string">&quot;启用:&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Switch</span> <span class="attr">HorizontalOptions</span>=<span class="string">&quot;StartAndExpand&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">IsToggled</span>=<span class="string">&quot;&#123;Binding Work&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">StackLayout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Label</span> <span class="attr">Text</span>=<span class="string">&quot;注释:&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Editor</span> <span class="attr">Placeholder</span>=<span class="string">&quot;输入注释&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding Note&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">MaxLength</span>=<span class="string">&quot;300&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">HeightRequest</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">Margin</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Grid.ColumnDefinitions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">&quot;*&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">&quot;*&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Grid.ColumnDefinitions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Text</span>=<span class="string">&quot;保存&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">Clicked</span>=<span class="string">&quot;OnSaveButtonClicked&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Grid.Column</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">Text</span>=<span class="string">&quot;删除&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">Clicked</span>=<span class="string">&quot;OnDeleteButtonClicked&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">StackLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ContentPage</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="闹钟条目的CRUD"><a href="#闹钟条目的CRUD" class="headerlink" title="闹钟条目的CRUD"></a>闹钟条目的CRUD</h4><p>因为我们将在整个程序的不同部分通用我们封装的 <code>Database</code> 这个数据库，所以在 <code>App.xaml.cs</code> 中将其实例化：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">App</span> : <span class="title">Application</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Database database;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Database Database</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (database == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                database = <span class="keyword">new</span> Database(Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), <span class="string">&quot;alarm.db3&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> database;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后就可以在各处调用了，接下来我们将数据与界面联系起来。</p>
<p>在 <code>AlarmPage</code> 的 <code>OnAppearing</code> 中，我们将写这样的一行代码：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alarmListView.ItemsSource = <span class="keyword">await</span> App.Database.GetAllAlarmItemsAsync();</span><br></pre></td></tr></table></figure>
<p>这行代码将会把数据库中储存的所有闹钟条目读取出来，加载到界面上的 ListView 里。</p>
<p>然后，在 <code>AlarmEditPage</code> 中完成 保存、删除 两个按钮的点击事件处理：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">async</span> <span class="keyword">void</span> <span class="title">OnSaveButtonClicked</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> alarmItem = (AlarmItem)BindingContext;</span><br><span class="line">    <span class="keyword">await</span> App.Database.SaveAlarmItemAsync(alarmItem);</span><br><span class="line">    <span class="keyword">await</span> Navigation.PopAsync();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">async</span> <span class="keyword">void</span> <span class="title">OnDeleteButtonClicked</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> alarmItem = (AlarmItem)BindingContext;</span><br><span class="line">    <span class="keyword">await</span> App.Database.DeleteAlarmItemAsync(alarmItem);</span><br><span class="line">    <span class="keyword">await</span> Navigation.PopAsync();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在取出页面里显示的条目后，调用数据库中保存/删除它，然后退出到 <code>AlarmPage</code>。</p>
<h4 id="闹钟提醒"><a href="#闹钟提醒" class="headerlink" title="闹钟提醒"></a>闹钟提醒</h4><p>现在我们可以新建、保存、编辑、删除闹钟条目了，但这些还都是数据上的操作，接下来实现闹钟的提醒功能。</p>
<p>闹钟需要在指定的时间响起以提醒用户，我们可以要为每一个闹钟条目调用系统级的定时事件（模仿系统自带的闹钟功能），这个方法感觉很牛皮，但在代码实现、尤其是跨平台实现上麻烦，我不确定（没有尝试）这样的操作是否可以显著提升程序性能，我们只是做个简单的小闹钟作业，没有必要如此。所以我采用了最简单直观的方法——每隔一段时间检测一次是否有闹钟到时。这样做法最方便的地方是，可以和 ClockPage 里的时钟指针更新事件共用一个 Timer：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">bool</span> <span class="title">OnTimerTick</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DateTime dateTime = DateTime.Now;</span><br><span class="line"></span><br><span class="line">    ... <span class="comment">// Do ui changes</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (dateTime.Second % <span class="number">30</span> &lt;= <span class="number">1</span> &amp;&amp; dateTime.Minute != _lastCheck)  <span class="comment">// To avoid high cpu occupying</span></span><br><span class="line">    &#123;</span><br><span class="line">        _lastCheck = dateTime.Minute;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 整点报时</span></span><br><span class="line">        <span class="keyword">if</span> (onTheHourToggle.IsToggled &amp;&amp; dateTime.Minute == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Notify(dateTime.Hour);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 定时的闹钟</span></span><br><span class="line">        List&lt;AlarmItem&gt; alarms = App.Database.GetAllAlarmItemsAsync().Result;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> a <span class="keyword">in</span> alarms)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (a.Work &amp;&amp; isOnTime(a.Time, dateTime))</span><br><span class="line">            &#123;</span><br><span class="line">                Notify(a);</span><br><span class="line">                a.Work = <span class="literal">false</span>;</span><br><span class="line">                App.Database.SaveAlarmItemAsync(a);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">bool</span> <span class="title">isOnTime</span>(<span class="params">TimeSpan t, DateTime d</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> t.Hours == d.Hour &amp;&amp; t.Minutes == d.Minute;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意我们设置的 Timer 在一秒内是要 Tick 好多次的，但闹钟到时检测只应该每分钟0秒时做一次（我再加了一次在30秒时的防止意外），所以有了 <code>dateTime.Second % 30 &lt;= 1 &amp;&amp; dateTime.Minute != _lastCheck</code> 这样的代码</p>
<p>在 <code>Notify</code> 方法中完成具体的通知用户的行为，比如弹出一个对话框：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// For 闹钟</span></span><br><span class="line"><span class="keyword">await</span> DisplayAlert(alarmItem.TimeString, alarmItem.Note, <span class="string">&quot;OK&quot;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// For 整点报时</span></span><br><span class="line"><span class="keyword">await</span> DisplayAlert(<span class="string">&quot;整点报时&quot;</span>, <span class="string">&quot;现在时间&quot;</span> + hour + <span class="string">&quot;点整。&quot;</span>, <span class="string">&quot;OK&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>其实，我还实现了闹钟到时播放音乐以及语音整点报时的功能，只要在 <code>Notify</code> 方法中加入对应的操作就行了，在此不赘述。但这些关于音频的实现在 iOS 和 Android 里没有任何问题，但我一次都没有成功在 UWP 上弄出来，可能是需要设置一下解决方案的打包方式什么的，但我没有找到 Microsoft 相应的文档介绍，咱也没深入研究😂。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>至此，整个跨平台小闹钟项目就大概介绍完了，时间关系，我省略了太多的细节，可以到 Github 阅读源码，<a target="_blank" rel="noopener" href="https://github.com/cdfmlr/MyClock">https://github.com/cdfmlr/MyClock</a> 。</p>
<p>通过这个项目，我们可以大概了解 C# 语言和 利用 Xamarin.Forms 开发跨平台 App 的方法，但需要一定的 Android/iOS/Flutter/UWP 开发基础才能很好的理解这些代码。其实，写完这个东西，虽然简单，基本稍微设计一下就照着文档写就好了，五六百行代码，几个小时搞定，但我还是很有收获的。C# 的好多地方感觉真的比 Java 写着方便（最显著的是 getter 和 setter），然而命名习惯什么的不太习惯，至于效率咱没详细研究也没有结论。Xamarin 也很好用，写起来代码简单易懂、开发速度比较快，比原生 Android 开发方便很多，跨平台的 UI 效果也确实不错（除了在微软自家的 UWP 下有小 Bugs😂） 。</p>
<p>再说一下不足。第一，我没有下功夫做 UI 设计，所以比较丑；第二，如前面多次提到的，这个实现在 UWP 平台下的效果不佳；最后，其实这个实现并没有完成题目要求的“最小化到系统托盘”（Xamarin 没有提供这种操作，这个东西显然跨不了平台，只能在 Windows 里实现）、“保存为文本文件”（我们知道，SQLite 算是二进制储存，谈不上“文本文件”）等。</p>
<h2 id="另一种实现"><a href="#另一种实现" class="headerlink" title="另一种实现"></a>另一种实现</h2><p>基于前面所说的诸多不足，我又借了一台 Windows PC，参考马老师多年前的文章 <a target="_blank" rel="noopener" href="https://blog.csdn.net/lsgo_myp/article/details/53148238">利用C#语言实现小闹钟</a>，写了 <a target="_blank" rel="noopener" href="https://github.com/cdfmlr/Alarm-WindowsForms">Alarm-WindowsForms</a> 项目，一个更符合题目要求但更加粗制滥造的 WindowsForms 实现。</p>
<p>WindowsForms 毕竟是上一个年代的产物了，它设计出来的东西也还是老的 Windows 样式，跟微软现在的 Fluent Design 一点边都不沾，除了历史遗留下来那些部分微软现在自家软件的开发也不用这个了，这东西在 VS 2019 里的设计界面里显示的居然都是个 Windows vista/7 样子的窗体😂。</p>
<p>我没有好好研究 C# 写 WindowsForms 的知识，整个实现基本就是凭 直觉 + 马老师的文章 + 小时候学 VB 残存的记忆。而且由于我不熟悉 Windows 和 Visual Studio 的操作，我甚至连对新建出来的类的命名都没做（吐槽一下 Windows 下 VS 的逻辑，新建一个 Class 或者其他什么东西的时候居然没有输入名称的地方，自动搞出些 Class1、Class2 之类的东西来，然后咱也不敢去重命名它，怕解决方案里注册的信息不对了（VS For Mac 有这个毛病，不知道 Win 上的如何）），所以不打算详细写了，大致的设计如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">WindowsForms 小闹钟程序</span><br><span class="line">    |-- UI</span><br><span class="line">    |    |-- 在程序载入时绘制界面，读取储存的闹钟数据</span><br><span class="line">    |    |-- 在 Timer Tick (每1秒) 时:</span><br><span class="line">    |	 |	 	动态更新圆盘时钟</span><br><span class="line">    |	 |		检测是否整点报时或闹钟提醒</span><br><span class="line">    |    |-- 在用户添加新闹钟时创建 Alarm 实例</span><br><span class="line">    |	 |	 	借助 AlarmDatabase 储存，并写入磁盘</span><br><span class="line">    |    |-- 在用户编辑&#x2F;删除闹钟时:</span><br><span class="line">    |	 |		借助 AlarmDatabase 修改&#x2F;删除 Alarm 实例</span><br><span class="line">    |	 |	 	同时也从磁盘文件中修改&#x2F;删除数据</span><br><span class="line">    |    |-- 在最小化&#x2F;关闭时处理最小化到系统托盘</span><br><span class="line">    |</span><br><span class="line">    |-- 相关类</span><br><span class="line">         |-- class Alarm: 闹钟类，代表程序运行时的一个闹钟对象</span><br><span class="line">         |-- class AlarmDatabase: 闹钟数据库</span><br><span class="line">         |      	处理将内存中的闹钟数据储存到磁盘以及从磁盘读取已保存的数据</span><br><span class="line">         |-- class TickMarkDrawHelper: 计算表盘刻度坐标的辅助类</span><br></pre></td></tr></table></figure>
<p>运行效果：</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1g9vdfrwji1j30m40d8dg5.jpg" alt="1"></p>
<p>写这个实现收获就没有太多了，无非是再熟悉了一下 C# 还有 WindowsForms，但感触倒是颇多。写这个东西的时候，我想起自己一开始学编程的时候接触的 VB，当时用一台磁盘只有 10 GB 的 Windows 98 笔记本，跑年纪比自己还大的 VS6.0 （当时好像还是一个个分开的 VC6.0、VB6.0 什么的），那个时候写的 VB 就和现在这个 WindowsForms in C# 一样，还是那几个熟悉的控件，只是开发语言从 BASIC 变成了 C#。这个时候才猛然回忆起，从我的第一个 Hello World 到今天也有8年了……今后也还会一直继续这段程序人生，虽然写代码从来都不是我最喜欢的事，但是没办法，谁让我乐意呢……</p>

  </div>
</article>
<!--Disqus-->


<!--Livere-->

    <div class="blog-post-comments">
        <div id="lv-container" data-id="city" data-uid="MTAyMC80NjEzMi8yMjY0Mw==">
            <noscript>不启用 JavaScript 支持的人是看不到可爱的评论区的。😥</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A9%E7%94%A8-C-%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E8%B7%A8%E5%B9%B3%E5%8F%B0%E5%B0%8F%E9%97%B9%E9%92%9F"><span class="toc-number">1.</span> <span class="toc-text">利用 C# 语言实现跨平台小闹钟</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.2.</span> <span class="toc-text">设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.</span> <span class="toc-text">实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%86%E7%9B%98%E6%97%B6%E9%92%9F%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.1.</span> <span class="toc-text">圆盘时钟的实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E7%9B%98"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">表盘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E9%92%88"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">指针</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.2.</span> <span class="toc-text">闹钟功能实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">闹钟、数据库模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E7%9B%B8%E5%85%B3%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">闹钟相关的页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E6%9D%A1%E7%9B%AE%E7%9A%84CRUD"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">闹钟条目的CRUD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%B9%E9%92%9F%E6%8F%90%E9%86%92"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">闹钟提醒</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%A6%E4%B8%80%E7%A7%8D%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.5.</span> <span class="toc-text">另一种实现</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&text=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&is_video=false&description=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=利用 C# 语言实现跨平台小闹钟&body=Check out this article: https://clownote.github.io/2019/12/10/blog/CSharpAlarm/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&title=利用 C# 语言实现跨平台小闹钟"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://clownote.github.io/2019/12/10/blog/CSharpAlarm/&name=利用 C# 语言实现跨平台小闹钟&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 CDFMLR
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-146911386-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?9a0d2e6fde93dad496ac79f04f3aba97";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


<!--Livere Comments-->

    <script type="text/javascript">
      (function (d, s) {
        var j, e = d.getElementsByTagName(s)[0];

        if (typeof LivereTower === 'function') { return; }

        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;

        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>

</body>
</html>
