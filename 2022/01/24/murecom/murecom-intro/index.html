<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿæœ¬æ–‡æä¾›ä¸¤ç§ç®€å•çš„ä¼ ç»ŸéŸ³ä¹æ¨èç³»ç»Ÿï¼ˆnext-songs æ–¹å‘ï¼‰çš„æ€è·¯ä¸å®ç°ã€‚ï¼ˆæ•°å­¦åŸç†å’Œæœºå™¨å­¦ä¹ æ–¹æ³•ä»ç•¥ï¼‰ ä¸‹æ–‡ä»…ç»™å‡ºæ€è·¯ä»¥åŠå…³é”®ä»£ç ï¼Œå®Œæ•´å®ç°è§: https:&#x2F;&#x2F;github.com&#x2F;cdfmlr&#x2F;murecom-intro 1. åŸºäºéŸ³é¢‘ç‰¹å¾åˆ†æéŸ³é¢‘ç‰¹å¾ï¼ŒåšåŸºäºå†…å®¹çš„æ¨èï¼ˆContent-Based Filteringï¼ŒCBF)ã€‚ 1.1 è®¾è®¡æ€è·¯ä¸€ä¸ªå–œæ¬¢å·´èµ«çš„äººå¯èƒ½ä¹Ÿå–œ">
<meta property="og:type" content="article">
<meta property="og:title" content="åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ">
<meta property="og:url" content="https://clownote.github.io/2022/01/24/murecom/murecom-intro/index.html">
<meta property="og:site_name" content="clownote">
<meta property="og:description" content="ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿæœ¬æ–‡æä¾›ä¸¤ç§ç®€å•çš„ä¼ ç»ŸéŸ³ä¹æ¨èç³»ç»Ÿï¼ˆnext-songs æ–¹å‘ï¼‰çš„æ€è·¯ä¸å®ç°ã€‚ï¼ˆæ•°å­¦åŸç†å’Œæœºå™¨å­¦ä¹ æ–¹æ³•ä»ç•¥ï¼‰ ä¸‹æ–‡ä»…ç»™å‡ºæ€è·¯ä»¥åŠå…³é”®ä»£ç ï¼Œå®Œæ•´å®ç°è§: https:&#x2F;&#x2F;github.com&#x2F;cdfmlr&#x2F;murecom-intro 1. åŸºäºéŸ³é¢‘ç‰¹å¾åˆ†æéŸ³é¢‘ç‰¹å¾ï¼ŒåšåŸºäºå†…å®¹çš„æ¨èï¼ˆContent-Based Filteringï¼ŒCBF)ã€‚ 1.1 è®¾è®¡æ€è·¯ä¸€ä¸ªå–œæ¬¢å·´èµ«çš„äººå¯èƒ½ä¹Ÿå–œ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k4hq2gj30uk0foq4e.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k3oivgj30tc0q83z9.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k5fbx4j315m0nu418.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k60g95j30p008yq3v.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k911qyj312u0p6gpn.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k7om7vj30vw0sedjf.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1kbsf0zj318y0j0jvc.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1kamvs4j31kq0mugo2.jpg">
<meta property="article:published_time" content="2022-01-24T20:59:03.776Z">
<meta property="article:modified_time" content="2022-06-15T09:00:04.627Z">
<meta property="article:author" content="CDFMLR">
<meta property="article:tag" content="CDFMLR, blogs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k4hq2gj30uk0foq4e.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/rabbit.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/rabbit_192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/rabbit_180.png">
          
        
    
    <!-- title -->
    <title>åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
    <!--Google search varification (PRIVATE)-->
    <meta name="google-site-verification" content="MrqlpFAD8nDanw3Ypv7ZsIWHLnTdhRuLa4QhSVwxIvc" />
    <!--Google AdSense å…³è” (PRIVATE)-->
    <script data-ad-client="ca-pub-1510963483941114" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">é¦–é¡µ</a></li>
         
          <li><a href="/about/">å…³äº</a></li>
         
          <li><a href="/archives/">å½’æ¡£</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">é¡¹ç›®</a></li>
         
          <li><a href="/search/">æœç´¢</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2022/03/03/murecom/murecom-verse-1/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2022/01/05/blog/%E9%87%8D%E8%A3%85%20macOS%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%80%BB%E7%BB%93%E4%B8%8E%E6%95%99%E8%AE%AD/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://clownote.github.io/2022/01/24/murecom/murecom-intro/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&text=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&is_video=false&description=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ&body=Check out this article: https://clownote.github.io/2022/01/24/murecom/murecom-intro/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&name=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E9%9F%B3%E4%B9%90%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9F%BA%E4%BA%8E%E9%9F%B3%E9%A2%91%E7%89%B9%E5%BE%81"><span class="toc-number">1.1.</span> <span class="toc-text">1. åŸºäºéŸ³é¢‘ç‰¹å¾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 è®¾è®¡æ€è·¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%A8%A1%E5%9E%8B%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 æ¨¡å‹ä¼˜ç¼ºç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E6%94%B9%E8%BF%9B%E7%A9%BA%E9%97%B4"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 æ”¹è¿›ç©ºé—´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%9F%BA%E4%BA%8E%E7%8E%B0%E6%9C%89%E6%92%AD%E6%94%BE%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">1.2.</span> <span class="toc-text">2. åŸºäºç°æœ‰æ’­æ”¾åˆ—è¡¨æ•°æ®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 è·å–æ•°æ®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Word2vec"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 Word2vec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Surprise-KNNBaseline"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 Surprise KNNBaseline</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E6%A8%A1%E5%9E%8B%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 æ¨¡å‹ä¼˜ç¼ºç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E6%94%B9%E8%BF%9B%E7%A9%BA%E9%97%B4"><span class="toc-number">1.2.5.</span> <span class="toc-text">2.5 æ”¹è¿›ç©ºé—´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-number">1.3.</span> <span class="toc-text">å‚è€ƒæ–‡çŒ®</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">clownote</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-01-24T20:59:03.776Z" itemprop="datePublished">2022-01-24</time>
        
        (Updated: <time datetime="2022-06-15T09:00:04.627Z" itemprop="dateModified">2022-06-15</time>)
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><a href="#ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ" class="headerlink" title="ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"></a>ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ</h1><p>æœ¬æ–‡æä¾›ä¸¤ç§ç®€å•çš„ä¼ ç»ŸéŸ³ä¹æ¨èç³»ç»Ÿï¼ˆnext-songs æ–¹å‘ï¼‰çš„æ€è·¯ä¸å®ç°ã€‚ï¼ˆæ•°å­¦åŸç†å’Œæœºå™¨å­¦ä¹ æ–¹æ³•ä»ç•¥ï¼‰</p>
<p>ä¸‹æ–‡ä»…ç»™å‡ºæ€è·¯ä»¥åŠå…³é”®ä»£ç ï¼Œå®Œæ•´å®ç°è§: <a target="_blank" rel="noopener" href="https://github.com/cdfmlr/murecom-intro">https://github.com/cdfmlr/murecom-intro</a></p>
<h2 id="1-åŸºäºéŸ³é¢‘ç‰¹å¾"><a href="#1-åŸºäºéŸ³é¢‘ç‰¹å¾" class="headerlink" title="1. åŸºäºéŸ³é¢‘ç‰¹å¾"></a>1. åŸºäºéŸ³é¢‘ç‰¹å¾</h2><p>åˆ†æéŸ³é¢‘ç‰¹å¾ï¼ŒåšåŸºäºå†…å®¹çš„æ¨èï¼ˆContent-Based Filteringï¼ŒCBF)ã€‚</p>
<h3 id="1-1-è®¾è®¡æ€è·¯"><a href="#1-1-è®¾è®¡æ€è·¯" class="headerlink" title="1.1 è®¾è®¡æ€è·¯"></a>1.1 è®¾è®¡æ€è·¯</h3><p>ä¸€ä¸ªå–œæ¬¢å·´èµ«çš„äººå¯èƒ½ä¹Ÿå–œæ¬¢è‚–é‚¦ï¼Œæ‰€ä»¥ä¸€ç§è‡ªç„¶çš„æƒ³æ³•æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠéŸ³é¢‘é€ç»™æœºå™¨è¿›è¡Œå­¦ä¹ ï¼Œè¯•å›¾è®©å®ƒåˆ†åˆ«ä¸åŒç§ç±»ã€é£æ ¼çš„éŸ³ä¹ã€‚ç»™å®šä¸€é¦–æ­Œï¼Œé€å…¥è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œæ¨èå‡ºé£æ ¼ä¸Šæœ€ç›¸è¿‘çš„å…¶ä»–æ­Œæ›²ã€‚</p>
<p><code>song-classification.ipynb</code> å®ç°äº†è¿™ç§æ¨¡å‹çš„è®­ç»ƒã€‚</p>
<p>åŠ æ‹¿å¤§ç»´å¤šåˆ©äºšå¤§å­¦çš„ genres æ•°æ®é›†ï¼ˆ<a target="_blank" rel="noopener" href="http://opihi.cs.uvic.ca/sound/genres.tar.gz%EF%BC%89%EF%BC%8C%E6%8F%90%E4%BE%9B%E4%BA%86%E8%89%AF%E5%A5%BD%E6%A0%87%E6%B3%A8%E7%9A%84%E4%B8%8D%E5%90%8C%E7%A7%8D%E7%B1%BB%E9%9F%B3%E4%B9%90%E7%89%87%E6%AE%B5%E3%80%82">http://opihi.cs.uvic.ca/sound/genres.tar.gzï¼‰ï¼Œæä¾›äº†è‰¯å¥½æ ‡æ³¨çš„ä¸åŒç§ç±»éŸ³ä¹ç‰‡æ®µã€‚</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ls genres</span><br><span class="line">blues     country   hiphop    metal     reggae</span><br><span class="line">classical disco     jazz      pop       rock</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æŠŠè¿™äº›ç‰‡æ®µåˆ©ç”¨ librosa åº“è½¬åŒ–ä¸º<strong>æ¢…å°”é¢‘è°±å›¾</strong>ï¼ˆmel-spectrogramï¼‰ã€‚</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k4hq2gj30uk0foq4e.jpg" alt="æ•°æ®é›†ä¸­ hiphop é£æ ¼ç‰‡æ®µçš„å¹³å‡é¢‘è°±å›¾)"></p>
<p>(ä¸Šå›¾ä¸ºæ•°æ®é›†ä¸­ Hip-Hop é£æ ¼ç‰‡æ®µçš„å¹³å‡é¢‘è°±å›¾)</p>
<p>æŠŠé¢‘è°±é€å…¥ä¸€ä¸ªä¸€ç»´å·ç§¯æ± åŒ–å †å  + å…¨è¿æ¥åˆ†ç±»å¤´çš„ç¥ç»ç½‘ç»œï¼Œè®­ç»ƒï¼Œå¾—åˆ°çš„æ¨¡å‹å³ä¸€ä¸ªéŸ³ä¹é£æ ¼æ£€æµ‹å™¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cnn_model</span>(<span class="params">input_shape</span>):</span></span><br><span class="line">    inputs = Input(input_shape)</span><br><span class="line">    x = inputs</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸€ç»´å·ç§¯æ± åŒ–</span></span><br><span class="line">    levels = <span class="number">64</span></span><br><span class="line">    <span class="keyword">for</span> level <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        x = Conv1D(levels, <span class="number">3</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">        x = BatchNormalization()(x)</span><br><span class="line">        x = MaxPooling1D(pool_size=<span class="number">2</span>, strides=<span class="number">2</span>)(x)</span><br><span class="line">        levels *= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># x -&gt; shape(128)</span></span><br><span class="line">    x = GlobalMaxPooling1D()(x)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¡ç®—ç±»å‹æ ‡ç­¾çš„å…¨è¿æ¥ç½‘ç»œ</span></span><br><span class="line">    <span class="keyword">for</span> fc <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        x = Dense(<span class="number">256</span>, activation=<span class="string">&#x27;relu&#x27;</span>)(x)</span><br><span class="line">        x = Dropout(<span class="number">0.5</span>)(x)</span><br><span class="line"></span><br><span class="line">    labels = Dense(<span class="number">10</span>, activation=<span class="string">&#x27;softmax&#x27;</span>)(x)</span><br><span class="line"></span><br><span class="line">    model = Model(inputs=[inputs], outputs=[labels])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># optimizer and compile model</span></span><br><span class="line">    sgd = SGD(learning_rate=<span class="number">0.0003</span>, momentum=<span class="number">0.9</span>, decay=<span class="number">1e-5</span>, nesterov=<span class="literal">True</span>)</span><br><span class="line">    model.<span class="built_in">compile</span>(optimizer=sgd, loss=<span class="string">&#x27;categorical_crossentropy&#x27;</span>, metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">model = cnn_model((<span class="number">128</span>, <span class="number">128</span>))</span><br></pre></td></tr></table></figure>

<p>è®­ç»ƒå¾—å‡ºçš„æ¨¡å‹ <code>song_classify.h5</code> å¯ä»¥å¾ˆå¥½çš„åˆ†ç±»ç‰¹å¾æ˜æ˜¾çš„éŸ³ä¹ç±»å‹ï¼ˆä¾‹å¦‚å¤å…¸ä¹ï¼‰ï¼Œä½†å¯¹ç•Œé™ç›¸å¯¹æ¨¡ç³Šçš„ä¹ç§ï¼ˆå¦‚æ‘‡æ»šä¹ï¼‰åˆ†ç±»æ•ˆæœæ¬ ä½³ã€‚</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k3oivgj30tc0q83z9.jpg" alt="åˆ†ç±»ç»“æœçš„æ··æ·†çŸ©é˜µ"></p>
<p>(åˆ†ç±»ç»“æœçš„æ··æ·†çŸ©é˜µ)</p>
<p>åˆ©ç”¨è¿™ä¸ªæ¨¡å‹ï¼Œåœ¨ <code>index-local-mp3s.ipynb</code> ä¸­å®ç°äº†ç›¸ä¼¼éŸ³ä¹çš„æ¨èã€‚</p>
<p>å…·ä½“çš„åšæ³•æ˜¯ï¼Œæ‰‹åŠ¨åšäº†ä¸€ä¸ªç®€å•çš„æ•°æ®é›†ï¼Œé€‰å–ä¸€äº›ä¸ªäººå¸¸å¬çš„éŸ³ä¹ï¼Œè½¬åŒ–ä¸ºåŒæ ·å“è´¨çš„ mp3 æ–‡ä»¶ã€‚</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k5fbx4j315m0nu418.jpg" alt="æœ¬åœ°éŸ³ä¹æ•°æ®é›†"></p>
<p>(é€‰å–çš„éŸ³ä¹ç§ç±»)</p>
<p>éå†å¤„ç†è¿™äº›æ–‡ä»¶ï¼Œæå–æ¢…å°”é¢‘è°±å›¾ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_mp3</span>(<span class="params">path</span>):</span></span><br><span class="line">    signal, sr = librosa.load(path,</span><br><span class="line">                              res_type=<span class="string">&quot;kaiser_fast&quot;</span>,</span><br><span class="line">                              offset=<span class="number">30</span>,</span><br><span class="line">                              duration=<span class="number">30</span>)</span><br><span class="line">    melspec = librosa.feature.melspectrogram(signal, sr=sr).T[:<span class="number">1280</span>, ]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(melspec) != <span class="number">1280</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&#x27;path&#x27;</span>: path,</span><br><span class="line">            <span class="string">&#x27;melspecs&#x27;</span>: np.asarray(np.split(melspec, <span class="number">10</span>))&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹æ¯ä¸ª MP3 çš„æ‰€æœ‰é¢‘è°±è¿›è¡Œç´¢å¼•</span></span><br><span class="line">songs = [process_mp3(path) <span class="keyword">for</span> path <span class="keyword">in</span> tqdm(mp3s)]</span><br><span class="line">songs = [song <span class="keyword">for</span> song <span class="keyword">in</span> songs <span class="keyword">if</span> song]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥æŠŠä»–ä»¬è¿åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿ä¸€æ‰¹å®Œæˆ</span></span><br><span class="line">inputs = []</span><br><span class="line"><span class="keyword">for</span> song <span class="keyword">in</span> songs:</span><br><span class="line">    inputs.extend(song[<span class="string">&#x27;melspecs&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥å°†é¢„å¤„ç†å¥½çš„æ•°æ®é›†é€å…¥è®­ç»ƒå¥½çš„æ¨¡å‹ã€‚</p>
<p>ç”±äºæˆ‘ä»¬åªéœ€è¦æå–éŸ³é¢‘ç‰¹å¾ï¼Œè€Œå¹¶ä¸éœ€è¦åšåˆ†ç±»ï¼Œæ‰€ä»¥æŠŠæ¨¡å‹æœ€ååŸºå±‚çš„å…¨è¿æ¥åˆ†ç±»å¤´å»æ‰ï¼Œåªç•™ä¸‹å‰é¢çš„å·ç§¯ç‰¹å¾æå–å±‚ã€‚è¾“å…¥éŸ³é¢‘é¢‘è°±ï¼Œè¾“å‡ºä¸€ä¸ª 256 ç»´çš„å‘é‡ä½œä¸ºéŸ³ä¹çš„â€œç‰¹å¾å‘é‡â€ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cnn_model = load_model(<span class="string">&#x27;song_classify.h5&#x27;</span>)</span><br><span class="line">vectorize_model = Model(inputs=cnn_model.<span class="built_in">input</span>,</span><br><span class="line">                        outputs=cnn_model.layers[-<span class="number">4</span>].output)</span><br><span class="line">vectors = vectorize_model.predict(inputs)</span><br></pre></td></tr></table></figure>

<p>å»ºç«‹ä¸€ä¸ªæ— ç›‘ç£çš„æœ€é‚»è¿‘æ¨¡å‹ï¼Œè®¡ç®—è¿™äº›ç‰¹å¾å‘é‡çš„ç›¸ä¼¼åº¦ï¼Œä¹Ÿå°±å…¶ä»£è¡¨çš„ mp3 æ­Œæ›²çš„ç›¸ä¼¼åº¦ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">nbrs = NearestNeighbors(</span><br><span class="line">    n_neighbors=<span class="number">10</span>, algorithm=<span class="string">&#x27;ball_tree&#x27;</span></span><br><span class="line">).fit(vectors)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">most_similar_songs</span>(<span class="params">song_idx</span>):</span></span><br><span class="line">    distances, indices = nbrs.kneighbors(</span><br><span class="line">        vectors[song_idx * <span class="number">10</span>: song_idx * <span class="number">10</span> + <span class="number">10</span>])</span><br><span class="line">    c = Counter()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> indices:</span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> row[<span class="number">1</span>:]:</span><br><span class="line">            c[idx // <span class="number">10</span>] += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> c.most_common()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_similar_songs</span>(<span class="params">song_idx, start=<span class="number">1</span>, end=<span class="number">6</span></span>):</span></span><br><span class="line">    print(<span class="string">&quot;æŒ‡å®šæ­Œæ›²:&quot;</span>, song_name(song_idx))</span><br><span class="line">    <span class="keyword">for</span> idx, score <span class="keyword">in</span> most_similar_songs(song_idx)[start:end]:</span><br><span class="line">        print(<span class="string">f&quot;[ç›¸ä¼¼åº¦<span class="subst">&#123;score&#125;</span>] <span class="subst">&#123;song_name(idx)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>æœ€åï¼Œç»™å®šä¸€é¦–æ­Œï¼Œå°±å¯ä»¥ä»æœ€é‚»è¿‘æ¨¡å‹ä¸­æ‰¾åˆ°æœ€æ¥è¿‘çš„å‡ é¦–æ­Œã€‚</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k60g95j30p008yq3v.jpg" alt="genres_result"></p>
<p>ï¼ˆæ¨èç»“æœç¤ºä¾‹ï¼‰</p>
<p>æ¨¡å‹æœ€ç»ˆè¡¨ç°è¿˜è¡Œå§ã€‚åªæ˜¯å’Œåˆ†ç±»çš„ç»“æœç±»ä¼¼ï¼Œä¸å–„äºå¤„ç†æ‘‡æ»šä¹ã€‚</p>
<h3 id="1-2-æ¨¡å‹ä¼˜ç¼ºç‚¹"><a href="#1-2-æ¨¡å‹ä¼˜ç¼ºç‚¹" class="headerlink" title="1.2 æ¨¡å‹ä¼˜ç¼ºç‚¹"></a>1.2 æ¨¡å‹ä¼˜ç¼ºç‚¹</h3><p>è¿™æ˜¯æˆ‘æ¯”è¾ƒå–œæ¬¢çš„ä¸€ç§æ–¹å¼ï¼Œä»éŸ³ä¹æœ¬èº«çš„ç‰¹å¾å‡ºå‘ï¼Œä¸åŸºäºä»¥å¾€ç”¨æˆ·æ•°æ®ï¼Œæ²¡æœ‰æ›²ç›®åˆ—è¡¨é™åˆ¶ã€‚å€ŸåŠ©è®­ç»ƒå¥½çš„åˆ†ç±»å™¨ç½‘ç»œï¼Œå¯ä»¥å¯¹ä»»æ„æ²¡è§è¿‡çš„éŸ³é¢‘è¿›è¡Œæ¨èã€‚</p>
<p>ä½†æ˜¯ï¼Œéœ€è¦å¤„ç†å®Œæ•´çš„éŸ³é¢‘ã€‚é¢‘è°±åˆ†æçš„è¿‡ç¨‹æ¯”è¾ƒæ¶ˆè€—ç®—åŠ›ã€‚å¹¶ä¸”åªèƒ½æ¨èæœ¬åœ°æ‹¥æœ‰çš„æ›²ç›®åœ¨å¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥çœ‹ä½œä¸€ç§é™åˆ¶ã€‚</p>
<p>è¿™ç§æ¨¡å‹å¯ä»¥ç”¨äºç¦»çº¿çš„è®¾å¤‡ç«¯éŸ³ä¹æ¨èã€‚</p>
<h3 id="1-3-æ”¹è¿›ç©ºé—´"><a href="#1-3-æ”¹è¿›ç©ºé—´" class="headerlink" title="1.3 æ”¹è¿›ç©ºé—´"></a>1.3 æ”¹è¿›ç©ºé—´</h3><ol>
<li>ç”¨äºè®­ç»ƒåˆ†ç±»å™¨çš„ genres æ•°æ®é›†è™½ç„¶è´¨é‡æé«˜ï¼Œä½†æ•°æ®é‡ä¸å¤ªå¤§ã€‚è€ƒè™‘ç”¨æ›´å¤šæ•°æ®ï¼Œæˆ–è®¸èƒ½å¾—åˆ°æ›´å¥½çš„æ¨¡å‹ï¼›</li>
<li>åˆ†ç±»å™¨ç½‘ç»œçš„ç»“æ„ä¹Ÿæ¯”è¾ƒç²—ç³™ï¼Œå¯ä»¥è€ƒè™‘è¿›ä¸€æ­¥ç ”ç©¶è°ƒæ•´ã€‚ä¾‹å¦‚è€ƒè™‘ä½¿ç”¨é¢„è®­ç»ƒçš„ NLP æ¨¡å‹è¿›è¡Œè¿ç§»å­¦ä¹ ï¼Œæˆ–è®¸èƒ½æ›´åŠ æ•é”ï¼›</li>
<li>è€ƒè™‘æ„å»ºå¤šè¾“å…¥çš„æ¨¡å‹ï¼ˆæˆ–è€…ä½¿ç”¨å¤šä¸ªæ¨¡å‹ï¼‰ï¼ŒåŠ ä¸Šä¸€äº›å…¶ä»–æ–¹é¢çš„æ•°æ®ï¼Œæ¯”å¦‚æ­Œæ›²çš„å…ƒæ•°æ®ï¼ˆæ­Œåã€è‰ºäººã€ä¸“è¾‘ã€æ—¶å¸¸ç­‰ï¼‰ã€ä»¥åŠæ­Œè¯ç­‰ä¸å®¹æ˜“ä»é¢‘è°±ä¸­å¾—å‡ºçš„æ–¹é¢ã€‚</li>
</ol>
<h2 id="2-åŸºäºç°æœ‰æ’­æ”¾åˆ—è¡¨æ•°æ®"><a href="#2-åŸºäºç°æœ‰æ’­æ”¾åˆ—è¡¨æ•°æ®" class="headerlink" title="2. åŸºäºç°æœ‰æ’­æ”¾åˆ—è¡¨æ•°æ®"></a>2. åŸºäºç°æœ‰æ’­æ”¾åˆ—è¡¨æ•°æ®</h2><p>åŸºäºä»¥å¾€çš„ã€å…¶ä»–ç”¨æˆ·çš„æ•°æ®ï¼Œåš<strong>ååŒè¿‡æ»¤</strong>ï¼ˆCollaborative Filtering ï¼ŒCF) ã€‚</p>
<p>è¿™ç§æ€è·¯å…¶å®æ›´å¸¸è§ã€‚è·å–ä¸€ç³»åˆ—çš„äººå»ºå¥½çš„æ’­æ”¾åˆ—è¡¨ã€‚é€šè¿‡æŸç§æ–¹æ³•å»ºç«‹å…¶ä¸­æ›²ç›®çš„è·ç¦»å…³ç³»ã€‚ç»™å®šæ­Œæ›²ï¼Œæ¨èè·ç¦»æœ€è¿‘çš„ã€‚</p>
<h3 id="2-1-è·å–æ•°æ®"><a href="#2-1-è·å–æ•°æ®" class="headerlink" title="2.1 è·å–æ•°æ®"></a>2.1 è·å–æ•°æ®</h3><p>åœ¨ <code>spotify-playlist.ipynb</code> ä¸­ï¼Œåˆ©ç”¨ Spotify çš„ APIï¼Œéšæœºè·å–ä¸€äº›æ’­æ”¾åˆ—è¡¨ï¼ŒåŠå…¶ä¸­æ›²ç›®ï¼ˆåªæ˜¯è·å–å…ƒæ•°æ®ï¼Œä¸ä¸‹è½½éŸ³é¢‘ï¼‰ã€‚</p>
<p>ä½†ç”±äºè¿™ç§æ–¹æ³•éœ€è¦è·å–å¤§é‡æ•°æ®ï¼ˆéœ€è¦æ•°åä¸‡æ­Œæ›²ï¼‰ï¼Œè€Œç½‘ç»œã€æ•°æ®åº“ç¯å¢ƒéƒ½æœ‰é™åˆ¶ï¼ŒPython å®ç°ä¸ç”šç¨³å®šï¼Œéš¾ä»¥å®Œæˆå·¥ä½œï¼Œæ‰€ä»¥åœ¨ <code>spotify/</code> å­ç›®å½•ä¸­ï¼Œä½¿ç”¨ Golang é‡å†™äº†è¿™ä¸ªå®ç°ï¼Œæä¾›æ›´åŠ é²æ£’çš„æ•°æ®è·å–æœåŠ¡ï¼Œå°†è·å–çš„æ•°æ®å­˜æ”¾åœ¨ä¸€ä¸ª SQLite æ•°æ®åº“ä¸­ã€‚</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k911qyj312u0p6gpn.jpg" alt="spotifyplaylist"></p>
<p>ï¼ˆè·å–çš„æ’­æ”¾åˆ—è¡¨åŠæ›²ç›®æ•°æ®ï¼‰</p>
<p>è¿™é‡Œç›®å‰è·å–äº†æ•° GiB æ•°æ®ï¼ŒåŒ…å« 17 ä¸‡ä¸ªæ’­æ”¾åˆ—è¡¨ä¸­ï¼Œæ¥è‡ª 80 ä¸‡ä¸ªè‰ºäººçš„è¿‘ 500 ä¸‡é¦–æ­Œæ›²ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sqlite<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> playlists;</span><br><span class="line"><span class="number">177889</span></span><br><span class="line">sqlite<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> artists;</span><br><span class="line"><span class="number">801357</span></span><br><span class="line">sqlite<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> tracks;</span><br><span class="line"><span class="number">4995249</span></span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢å®ç°äº†ä¸¤ç§æ€è·¯æ¥åˆ©ç”¨è¿™äº›æ•°æ®ï¼š</p>
<h3 id="2-2-Word2vec"><a href="#2-2-Word2vec" class="headerlink" title="2.2 Word2vec"></a>2.2 Word2vec</h3><p>åœ¨ <code>train-a-music-recommender.ipynb</code> ä¸­ï¼Œå°†<strong>æ­Œæ›²ä½œä¸ºå•è¯</strong>ã€å°†æ­Œæ›²æœ€æˆçš„<strong>æ’­æ”¾åˆ—è¡¨ä½œä¸ºå¥å­</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sentences = [</span><br><span class="line">    [<span class="string">&quot;track_1_id&quot;</span>, <span class="string">&quot;track_2_id&quot;</span>, ...], <span class="comment"># playlist_1</span></span><br><span class="line">    [...], <span class="comment"># playlist_2</span></span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>ä»¥æ­¤ä¸ºè¯­æ–™ï¼Œå»ºç«‹ Word2vec æ¨¡å‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">model = gensim.models.Word2Vec(</span><br><span class="line">    sentences=PlaylistTracksIter(DB), min_count=<span class="number">4</span>)</span><br></pre></td></tr></table></figure>

<p>è®­ç»ƒå®Œæˆåï¼Œç»™å®šæ›²ç›®ï¼Œå¯è·å–åˆ°æœ€æ¥è¿‘çš„æ¨èã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">suggest_songs</span>(<span class="params">song_id</span>):</span></span><br><span class="line">    similar = <span class="built_in">dict</span>(model.wv.most_similar([song_id]))</span><br><span class="line">    song_ids = <span class="string">&#x27;, &#x27;</span>.join((<span class="string">&quot;&#x27;%s&#x27;&quot;</span> % x) <span class="keyword">for</span> x <span class="keyword">in</span> similar.keys())</span><br><span class="line"></span><br><span class="line">    c = conn.cursor()</span><br><span class="line">    c.execute(<span class="string">&quot;SELECT * FROM tracks WHERE id in (%s)&quot;</span> % song_ids)</span><br><span class="line"></span><br><span class="line">    res = <span class="built_in">sorted</span>((rec + (similar[rec[<span class="number">4</span>]], </span><br><span class="line">                         find_artists(rec[<span class="number">4</span>])</span><br><span class="line">                        ) <span class="keyword">for</span> rec <span class="keyword">in</span> c.fetchall()),</span><br><span class="line">        key=itemgetter(-<span class="number">1</span>),</span><br><span class="line">        reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> suggest_songs_result([*res])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">suggest_from</span>(<span class="params">song_name: <span class="built_in">str</span></span>):</span></span><br><span class="line">    s = find_song(song_name, limit=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> s + suggest_songs(s[<span class="number">0</span>][<span class="string">&quot;id&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ¨¡å‹ä¹Ÿå¯ç”¨ï¼Œä½†æ•ˆæœä¸ç®—ç‰¹åˆ«ç†æƒ³ã€‚</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1k7om7vj30vw0sedjf.jpg" alt="word2vec_result"></p>
<p>ï¼ˆWord2Vec æ¨¡å‹æ¨èå®ä¾‹ï¼‰</p>
<h3 id="2-3-Surprise-KNNBaseline"><a href="#2-3-Surprise-KNNBaseline" class="headerlink" title="2.3 Surprise KNNBaseline"></a>2.3 Surprise KNNBaseline</h3><p>åœ¨ <code>surprise.ipynb</code> ä¸­ï¼Œå°†æ­Œæ›²ä½œä¸º itemï¼Œå°†æ’­æ”¾åˆ—è¡¨ä½œä¸º userï¼Œæ’­æ”¾åˆ—è¡¨åŒ…å«æŸæ­Œæ›²å³çœ‹ä½œ user ç»™ item æ‰“äº†ä¸€åˆ†ï¼ˆrating=1ï¼‰ã€‚</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1kbsf0zj318y0j0jvc.jpg" alt="surprise_data"></p>
<p>å°†è¿™æ ·å¤„ç†å¥½çš„æ•°æ®é›†äº¤ç»™ Surprise è¿›è¡ŒåŸºæœ¬çš„<strong>ååŒè¿‡æ»¤</strong>ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> surprise <span class="keyword">import</span> KNNBaseline</span><br><span class="line"><span class="keyword">from</span> surprise <span class="keyword">import</span> Reader, Dataset</span><br><span class="line"></span><br><span class="line"><span class="comment"># custom dataset</span></span><br><span class="line">reader = Reader(rating_scale=(<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">train_data = Dataset.load_from_df(</span><br><span class="line">    pt_train[[<span class="string">&#x27;userID&#x27;</span>, <span class="string">&#x27;itemID&#x27;</span>, <span class="string">&#x27;rating&#x27;</span>]],</span><br><span class="line">    reader)</span><br><span class="line">trainset = train_data.build_full_trainset()</span><br><span class="line"></span><br><span class="line"><span class="comment"># compute  similarities between items</span></span><br><span class="line">sim_options = &#123;</span><br><span class="line">    <span class="string">&#x27;user_based&#x27;</span>: <span class="literal">False</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®—æ³•ã€è®­ç»ƒ</span></span><br><span class="line">algo = KNNBaseline(sim_options=sim_options)</span><br><span class="line">algo.fit(trainset)</span><br></pre></td></tr></table></figure>

<p>åŒæ ·å¾—åˆ° KNN çš„æ¨¡å‹ï¼Œç»™å®šæ­Œæ›²ï¼Œä»æ¨¡å‹ä¸­è·å–æœ€é‚»è¿‘çš„æ¨èã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_sim</span>(<span class="params">track_id, k=<span class="number">5</span></span>):</span></span><br><span class="line">    sim = algo.get_neighbors(</span><br><span class="line">        iid=algo.trainset.to_inner_iid(track_id), k=k)</span><br><span class="line"></span><br><span class="line">    track_ids = [track_id] + <span class="built_in">list</span>(</span><br><span class="line">        <span class="built_in">map</span>(algo.trainset.to_raw_iid, sim))</span><br><span class="line"></span><br><span class="line">    tracks = []</span><br><span class="line">    c = conn.cursor()</span><br><span class="line">    <span class="keyword">for</span> tid <span class="keyword">in</span> track_ids:</span><br><span class="line">        c.execute(<span class="string">f&quot;SELECT * FROM tracks WHERE id = &#x27;<span class="subst">&#123;tid&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">        tk = c.fetchall()[<span class="number">0</span>]</span><br><span class="line">        tracks.append(tk + (find_artists(tid),))</span><br><span class="line">    c.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sim_result(tracks)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªåšå‡ºæ¥æ•ˆæœä¸é”™ã€‚</p>
<p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gyp1kamvs4j31kq0mugo2.jpg" alt="surprise_result"></p>
<p>(Surprise æ¨¡å‹æ¨èç»“æœï¼ŒShout Baby æ˜¯è¾“å…¥çš„æ­Œæ›²ï¼Œä¸‹é¢ 5 é¦–æ˜¯æ¨èå‡ºçš„ï¼ŒäºŒåˆºèˆç‹‚å–œã€‚)</p>
<h3 id="2-4-æ¨¡å‹ä¼˜ç¼ºç‚¹"><a href="#2-4-æ¨¡å‹ä¼˜ç¼ºç‚¹" class="headerlink" title="2.4 æ¨¡å‹ä¼˜ç¼ºç‚¹"></a>2.4 æ¨¡å‹ä¼˜ç¼ºç‚¹</h3><p>è¿™ç§æ€è·¯æ˜¯ä¼ ç»Ÿçš„è¿‡å¾€ç”¨æˆ·æ•°æ®åˆ†æï¼Œæ˜¯æ¨èç³»ç»Ÿæ¯”è¾ƒå¸¸è§„çš„å®ç°æ–¹å¼ï¼Œæ–¹æ¡ˆè¾ƒä¸ºæˆç†Ÿã€‚åŸºäºæµ·é‡æ•°æ®ï¼Œå¯ä»¥è¾¾åˆ°æ¯”è¾ƒå¥½çš„æ¨èæ•ˆæœã€‚</p>
<p>ä½†æ˜¯ï¼Œå¤§æ•°æ®çš„å¤„ç†é€Ÿåº¦å¯èƒ½è¾ƒæ…¢ï¼Œå¹¶ä¸”å­˜å‚¨å™¨å¼€é”€ä¸æ˜¯ç»ˆç«¯å¯ä»¥æ‰¿å—çš„ã€‚åŒæ—¶ï¼Œå¯¹äºç”¨æˆ·ï¼ŒåŸºäºæ•°æ®çš„é‚»è¿‘æ¨èä¼šå®¹æ˜“é€ æˆä¿¡æ¯èŒ§æˆ¿é—®é¢˜ï¼Œå¹¶ä¸å¥åº·ã€‚</p>
<p>è¿™ç§æ–¹æ¡ˆå¯ä»¥ç”¨äºäº‘ç«¯çš„éŸ³ä¹æ¨èã€‚</p>
<h3 id="2-5-æ”¹è¿›ç©ºé—´"><a href="#2-5-æ”¹è¿›ç©ºé—´" class="headerlink" title="2.5 æ”¹è¿›ç©ºé—´"></a>2.5 æ”¹è¿›ç©ºé—´</h3><ol>
<li>ç®—æ³•ï¼šç›®å‰å®ç°çš„æ˜¯æœ€åŸºæœ¬çš„åŸºå‡†ç®—æ³•ï¼Œå¯ä»¥è€ƒè™‘å°è¯•å…¶ä»–çš„ç®—æ³•ã€‚</li>
<li>æ•°æ®ï¼šå¯¹äºè¿™ç§æ¨¡å‹æ›´å¤šçš„æ•°æ®å‡ ä¹ä¸€å®šä¼šå¸¦æ¥æ›´å¥½çš„ç»“æœã€‚</li>
<li>è€ƒè™‘æŠ“å–ç½‘æ˜“äº‘éŸ³ä¹çš„æ•°æ®ï¼Œå¯èƒ½æ›´ä¼˜è´¨ï¼šæœ¬åœŸåŒ–éŸ³ä¹ï¼Œè¯„è®ºã€çƒ­åº¦ã€æ’­æ”¾åˆ—è¡¨æ ‡ç­¾åˆ†ç±»ã€‚å¯ä»¥ç”¨æ›´ç»¼åˆçš„æ¨¡å‹è¿›è¡Œæ¨è</li>
</ol>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p>[1] Douwe Osinga. Deep Learning Cookbook[M]. Oâ€™Reilly, 2018: 210-227.</p>
<p>[2] Nicolas Hug. Surprise: A Python library for recommender systems[J]. Journal of Open Source Software, 2020, 5(52): 2174.</p>

  </div>
</article>
<!--Disqus-->


<!--Livere-->

    <div class="blog-post-comments">
        <div id="lv-container" data-id="city" data-uid="MTAyMC80NjEzMi8yMjY0Mw==">
            <noscript>ä¸å¯ç”¨ JavaScript æ”¯æŒçš„äººæ˜¯çœ‹ä¸åˆ°å¯çˆ±çš„è¯„è®ºåŒºçš„ã€‚ğŸ˜¥</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">é¦–é¡µ</a></li>
         
          <li><a href="/about/">å…³äº</a></li>
         
          <li><a href="/archives/">å½’æ¡£</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">é¡¹ç›®</a></li>
         
          <li><a href="/search/">æœç´¢</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E9%9F%B3%E4%B9%90%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9F%BA%E4%BA%8E%E9%9F%B3%E9%A2%91%E7%89%B9%E5%BE%81"><span class="toc-number">1.1.</span> <span class="toc-text">1. åŸºäºéŸ³é¢‘ç‰¹å¾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 è®¾è®¡æ€è·¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%A8%A1%E5%9E%8B%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 æ¨¡å‹ä¼˜ç¼ºç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E6%94%B9%E8%BF%9B%E7%A9%BA%E9%97%B4"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 æ”¹è¿›ç©ºé—´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%9F%BA%E4%BA%8E%E7%8E%B0%E6%9C%89%E6%92%AD%E6%94%BE%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">1.2.</span> <span class="toc-text">2. åŸºäºç°æœ‰æ’­æ”¾åˆ—è¡¨æ•°æ®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 è·å–æ•°æ®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Word2vec"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 Word2vec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Surprise-KNNBaseline"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 Surprise KNNBaseline</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E6%A8%A1%E5%9E%8B%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 æ¨¡å‹ä¼˜ç¼ºç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E6%94%B9%E8%BF%9B%E7%A9%BA%E9%97%B4"><span class="toc-number">1.2.5.</span> <span class="toc-text">2.5 æ”¹è¿›ç©ºé—´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="toc-number">1.3.</span> <span class="toc-text">å‚è€ƒæ–‡çŒ®</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://clownote.github.io/2022/01/24/murecom/murecom-intro/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&text=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&is_video=false&description=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ&body=Check out this article: https://clownote.github.io/2022/01/24/murecom/murecom-intro/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&title=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://clownote.github.io/2022/01/24/murecom/murecom-intro/&name=åŠ¨æ‰‹å†™ç®€å•çš„éŸ³ä¹æ¨èç³»ç»Ÿ&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2022 CDFMLR
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">é¦–é¡µ</a></li>
         
          <li><a href="/about/">å…³äº</a></li>
         
          <li><a href="/archives/">å½’æ¡£</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/cdfmlr">é¡¹ç›®</a></li>
         
          <li><a href="/search/">æœç´¢</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸ!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-146911386-1', 'auto');
        ga('send', 'pageview');
    </script>
    
    <!-- New: global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-146911386-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-146911386-1');
    </script>
    

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?9a0d2e6fde93dad496ac79f04f3aba97";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->


<!--Livere Comments-->

    <script type="text/javascript">
      (function (d, s) {
        var j, e = d.getElementsByTagName(s)[0];

        if (typeof LivereTower === 'function') { return; }

        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;

        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>


</body>
</html>
